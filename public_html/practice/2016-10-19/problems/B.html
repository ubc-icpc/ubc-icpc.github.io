
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h2 id="problem-x2-brackets">Problem B: Enumerating Brackets</h2>

<img align=right src="B.png">

<p>A <em>balanced bracket sequence</em> is a string consisting only of the characters "<code>(</code>" (opening brackets) and "<code>)</code>" (closing brackets) such that each opening bracket has a "matching" closing bracket, and vice versa. <!--</p> Formally, it is a string such that:</p>

<ol>
<li>The number of opening brackets is equal to the number of closing brackets, and</li>
<li>In any <em>prefix</em> of the string, the number of opening brackets is at least the number of closing brackets</li>
</ol>

<p>-->For example, "<code>(())()</code>" is a balanced bracket sequence, whereas "<code>(())(()</code>" and "<code>())(()</code>" are not.</p>

<p>Given two bracket sequences <em>A</em> and <em>B</em> of the same length, we say that <em>A</em> is <em>lexicographically smaller than</em> <em>B</em> (and write <em>A &lt; B</em>) if:</p>

<ol>
<li><em>A</em> and <em>B</em> differ in at least one position, and</li>
<li><em>A</em> has a "<code>(</code>", and <em>B</em> has a "<code>)</code>" in the left-most position in which <em>A</em> and <em>B</em> differ</li>
</ol>

<p>For example "<code>(())()</code>" &lt; "<code>()()()</code>" because they first differ in the second position from the left, and the first string has an "<code>(</code>" in that position, whereas the second string has a "<code>)</code>". For a given length <em>N</em>, the "<em>&lt;</em>" operator defines an <em>ordering</em> on all balanced bracket sequences of length <em>N</em>. For example, the ordering of the sequences of length <em>6</em> is:</p>

<ol>
<li><code>((()))</code></li>
<li><code>(()())</code></li>
<li><code>(())()</code></li>
<li><code>()(())</code></li>
<li><code>()()()</code></li>
</ol>

<p>Given a length <em>N</em> and a positive integer <em>M</em>, your task is to find the <em>M<sup>th</sup></em> balanced bracket sequence in the ordering.</p>


<h3>Input Specification</h3>

<p>You will be given an <em>even</em> integer <em>N</em> (<em>2 &leq; N &leq; 2000</em>), and a positive integer <em>M</em>. It is guaranteed that <em>M</em> will be no more than <em>10<sup>18</sup></em> and no more than the number of balanced bracket sequences of length <em>N</em> (whichever is smaller).</p>

<h3>Output Specification</h3>

<p>Output the <em>M<sup>th</sup></em> balanced bracket sequence of length <em>N</em>, when ordered lexicographically.</p>

<h3>Sample Input</h3>
<pre><code>6 4</code></pre>

<h3>Output for Sample Input</h3>
<pre><code>()(())</code></pre>

<hr />
<i>Deon Nicholas</i>
</body>
</html>
