(function(){for(var a,b=function(){},c="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd table time timeEnd timeStamp trace warn".split(" "),d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)})();
(function(){var a,b,c,d,e=[].slice,f={}.hasOwnProperty,g=function(a,c){function b(){this.constructor=a}for(var d in c)f.call(c,d)&&(a[d]=c[d]);b.prototype=c.prototype;a.prototype=new b;a.__super__=c.prototype;return a},h=function(a,c){return function(){return a.apply(c,arguments)}},m=[].indexOf||function(a){for(var c=0,b=this.length;c<b;c++)if(c in this&&this[c]===a)return c;return-1};b=window.Morris={};a=jQuery;b.EventEmitter=function(){function a(){}a.prototype.on=function(a,c){null==this.handlers&&
(this.handlers={});null==this.handlers[a]&&(this.handlers[a]=[]);return this.handlers[a].push(c)};a.prototype.fire=function(){var a,c,b,d,n,q;c=arguments[0];a=2<=arguments.length?e.call(arguments,1):[];if(null!=this.handlers&&null!=this.handlers[c]){n=this.handlers[c];q=[];b=0;for(d=n.length;b<d;b++)c=n[b],q.push(c.apply(null,a));return q}};return a}();b.commas=function(a){var c,b;return null!=a?(b=0>a?"-":"",c=Math.abs(a),a=Math.floor(c).toFixed(0),b+=a.replace(/(?=(?:\d{3})+$)(?!^)/g,","),c=c.toString(),
c.length>a.length&&(b+=c.slice(a.length)),b):"-"};b.pad2=function(a){return(10>a?"0":"")+a};b.Grid=function(c){function d(c){var b=this;this.el="string"===typeof c.element?a(document.getElementById(c.element)):a(c.element);if(null==this.el||0===this.el.length)throw Error("Graph container element not found");"static"===this.el.css("position")&&this.el.css("position","relative");this.options=a.extend({},this.gridDefaults,this.defaults||{},c);"string"===typeof this.options.units&&(this.options.postUnits=
c.units);this.raphael=new Raphael(this.el[0]);this.elementHeight=this.elementWidth=null;this.dirty=!1;this.init&&this.init();this.setData(this.options.data);this.el.bind("mousemove",function(a){var c;c=b.el.offset();return b.fire("hovermove",a.pageX-c.left,a.pageY-c.top)});this.el.bind("mouseout",function(a){return b.fire("hoverout")});this.el.bind("touchstart touchmove touchend",function(a){var c;c=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];a=b.el.offset();b.fire("hover",c.pageX-
a.left,c.pageY-a.top);return c});this.postInit&&this.postInit()}g(d,c);d.prototype.gridDefaults={dateFormat:null,axes:!0,grid:!0,gridLineColor:"#aaa",gridStrokeWidth:0.5,gridTextColor:"#888",gridTextSize:12,hideHover:!1,yLabelFormat:null,numLines:5,padding:25,parseTime:!0,postUnits:"",preUnits:"",ymax:"auto",ymin:"auto 0",goals:[],goalStrokeWidth:1,goalLineColors:["#666633","#999966","#cc6666","#663333"],events:[],eventStrokeWidth:1,eventLineColors:["#005a04","#ccffbb","#3a5f0b","#005502"]};d.prototype.setData=
function(a,c){var d,e,l,k,f,g,t,h,z,p,u,x;null==c&&(c=!0);if(null==a||0===a.length)this.data=[],this.raphael.clear(),null!=this.hover&&this.hover.hide();else if(p=this.cumulative?0:null,u=this.cumulative?0:null,0<this.options.goals.length&&(f=Math.min.apply(null,this.options.goals),k=Math.max.apply(null,this.options.goals),u=null!=u?Math.min(u,f):f,p=null!=p?Math.max(p,k):k),this.data=function(){var c,d,s;s=[];l=c=0;for(d=a.length;c<d;l=++c){t=a[l];g={};g.label=t[this.options.xkey];this.options.parseTime?
(g.x=b.parseDate(g.label),this.options.dateFormat?g.label=this.options.dateFormat(g.x):"number"===typeof g.label&&(g.label=(new Date(g.label)).toString())):g.x=l;h=0;var C=g,k=void 0,f=void 0,y=void 0,w=void 0,y=this.options.ykeys,w=[];e=k=0;for(f=y.length;k<f;e=++k)z=y[e],x=t[z],"string"===typeof x&&(x=parseFloat(x)),null!=x&&"number"!==typeof x&&(x=null),null!=x&&(this.cumulative?h+=x:null!=p?(p=Math.max(x,p),u=Math.min(x,u)):p=u=x),this.cumulative&&null!=h&&(p=Math.max(h,p),u=Math.min(h,u)),w.push(x);
C.y=w;s.push(g)}return s}.call(this),this.options.parseTime&&(this.data=this.data.sort(function(a,c){return(a.x>c.x)-(c.x>a.x)})),this.xmin=this.data[0].x,this.xmax=this.data[this.data.length-1].x,this.events=[],this.options.parseTime&&0<this.options.events.length&&(this.events=function(){var a,c,s,v;s=this.options.events;v=[];a=0;for(c=s.length;a<c;a++)d=s[a],v.push(b.parseDate(d));return v}.call(this),this.xmax=Math.max(this.xmax,Math.max.apply(null,this.events)),this.xmin=Math.min(this.xmin,Math.min.apply(null,
this.events))),this.xmin===this.xmax&&(this.xmin-=1,this.xmax+=1),this.ymin=this.yboundary("min",u),this.ymax=this.yboundary("max",p),this.ymin===this.ymax&&(u&&(this.ymin-=1),this.ymax+=1),this.yInterval=(this.ymax-this.ymin)/(this.options.numLines-1),this.precision=0<this.yInterval&&1>this.yInterval?-Math.floor(Math.log(this.yInterval)/Math.log(10)):0,this.dirty=!0,c)return this.redraw()};d.prototype.yboundary=function(a,c){var b;b=this.options["y"+a];return"string"===typeof b?"auto"===b.slice(0,
4)?5<b.length?(b=parseInt(b.slice(5),10),null==c?b:Math[a](c,b)):null!=c?c:0:parseInt(b,10):b};d.prototype._calc=function(){var a,c;c=this.el.width();a=this.el.height();if(this.elementWidth!==c||this.elementHeight!==a||this.dirty)if(this.elementWidth=c,this.elementHeight=a,this.dirty=!1,this.left=this.options.padding,this.right=this.elementWidth-this.options.padding,this.top=this.options.padding,this.bottom=this.elementHeight-this.options.padding,this.options.axes&&(a=Math.max(this.measureText(this.yAxisFormat(this.ymin),
this.options.gridTextSize).width,this.measureText(this.yAxisFormat(this.ymax),this.options.gridTextSize).width),this.left+=a,this.bottom-=1.5*this.options.gridTextSize),this.width=this.right-this.left,this.height=this.bottom-this.top,this.dx=this.width/(this.xmax-this.xmin),this.dy=this.height/(this.ymax-this.ymin),this.calc)return this.calc()};d.prototype.transY=function(a){return this.bottom-(a-this.ymin)*this.dy};d.prototype.transX=function(a){return 1===this.data.length?(this.left+this.right)/
2:this.left+(a-this.xmin)*this.dx};d.prototype.redraw=function(){this.raphael.clear();this._calc();this.drawGrid();this.drawGoals();this.drawEvents();if(this.draw)return this.draw()};d.prototype.drawGoals=function(){var a,c,b,d,e;d=this.options.goals;e=[];a=c=0;for(b=d.length;c<b;a=++c)a=d[a],e.push(this.drawGoal("M"+this.left+","+this.transY(a)+"H"+(this.left+this.width)));return e};d.prototype.drawEvents=function(){var a,c,b,d,e;d=this.events;e=[];a=c=0;for(b=d.length;c<b;a=++c)a=d[a],e.push(this.drawEvent("M"+
this.transX(a)+","+this.bottom+"V"+this.top));return e};d.prototype.drawGrid=function(){var a,c,b,d,e,l,k;if(!(!1===this.options.grid&&!1===this.options.axes)){a=this.ymin;c=this.ymax;k=[];b=e=a;for(l=this.yInterval;a<=c?e<=c:e>=c;b=e+=l)b=parseFloat(b.toFixed(this.precision)),d=this.transY(b),this.options.axes&&this.drawYAxisLabel(this.left-this.options.padding/2,d,this.yAxisFormat(b)),this.options.grid?k.push(this.drawGridLine("M"+this.left+","+d+"H"+(this.left+this.width))):k.push(void 0);return k}};
d.prototype.measureText=function(a,c){var b,d;null==c&&(c=12);d=this.raphael.text(100,100,a).attr("font-size",c);b=d.getBBox();d.remove();return b};d.prototype.yAxisFormat=function(a){return this.yLabelFormat(a)};d.prototype.yLabelFormat=function(a){return"function"===typeof this.options.yLabelFormat?this.options.yLabelFormat(a):""+this.options.preUnits+b.commas(a)+this.options.postUnits};d.prototype.updateHover=function(a,c){var b,d;b=this.hitTest(a,c);if(null!=b)return(d=this.hover).update.apply(d,
b)};d.prototype.drawGoal=function(a){return this.raphael.path(a).attr("stroke",this.options.goalLineColors[i%this.options.goalLineColors.length]).attr("stroke-width",this.options.goalStrokeWidth)};d.prototype.drawEvent=function(a){return this.raphael.path(a).attr("stroke",this.options.eventLineColors[i%this.options.eventLineColors.length]).attr("stroke-width",this.options.eventStrokeWidth)};d.prototype.drawYAxisLabel=function(a,c,b){return this.raphael.text(a,c,b).attr("font-size",this.options.gridTextSize).attr("fill",
this.options.gridTextColor).attr("text-anchor","end")};d.prototype.drawGridLine=function(a){return this.raphael.path(a).attr("stroke",this.options.gridLineColor).attr("stroke-width",this.options.gridStrokeWidth)};return d}(b.EventEmitter);b.parseDate=function(a){var c,b,d,e,n,q;if("number"===typeof a)return a;b=a.match(/^(\d+) Q(\d)$/);e=a.match(/^(\d+)-(\d+)$/);n=a.match(/^(\d+)-(\d+)-(\d+)$/);c=a.match(/^(\d+) W(\d+)$/);d=a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+)(Z|([+-])(\d\d):?(\d\d))?$/);q=
a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+):(\d+(\.\d+)?)(Z|([+-])(\d\d):?(\d\d))?$/);return b?(new Date(parseInt(b[1],10),3*parseInt(b[2],10)-1,1)).getTime():e?(new Date(parseInt(e[1],10),parseInt(e[2],10)-1,1)).getTime():n?(new Date(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10))).getTime():c?(q=new Date(parseInt(c[1],10),0,1),4!==q.getDay()&&q.setMonth(0,1+(4-q.getDay()+7)%7),q.getTime()+6048E5*parseInt(c[2],10)):d?d[6]?(a=0,"Z"!==d[6]&&(a=60*parseInt(d[8],10)+parseInt(d[9],10),"+"===d[7]&&
(a=0-a)),Date.UTC(parseInt(d[1],10),parseInt(d[2],10)-1,parseInt(d[3],10),parseInt(d[4],10),parseInt(d[5],10)+a)):(new Date(parseInt(d[1],10),parseInt(d[2],10)-1,parseInt(d[3],10),parseInt(d[4],10),parseInt(d[5],10))).getTime():q?(d=parseFloat(q[6]),c=Math.floor(d),d=Math.round(1E3*(d-c)),q[8]?(a=0,"Z"!==q[8]&&(a=60*parseInt(q[10],10)+parseInt(q[11],10),"+"===q[9]&&(a=0-a)),Date.UTC(parseInt(q[1],10),parseInt(q[2],10)-1,parseInt(q[3],10),parseInt(q[4],10),parseInt(q[5],10)+a,c,d)):(new Date(parseInt(q[1],
10),parseInt(q[2],10)-1,parseInt(q[3],10),parseInt(q[4],10),parseInt(q[5],10),c,d)).getTime()):(new Date(parseInt(a,10),0,1)).getTime()};b.Hover=function(){function c(d){null==d&&(d={});this.options=a.extend({},b.Hover.defaults,d);this.el=a("<div class='"+this.options["class"]+"'></div>");this.el.hide();this.options.parent.append(this.el)}c.defaults={"class":"morris-hover morris-default-style"};c.prototype.update=function(a,c,b){this.html(a);this.show();return this.moveTo(c,b)};c.prototype.html=function(a){return this.el.html(a)};
c.prototype.moveTo=function(a,c){var b,d,e,q;q=this.options.parent.innerWidth();e=this.options.parent.innerHeight();d=this.el.outerWidth();b=this.el.outerHeight();d=Math.min(Math.max(0,a-d/2),q-d);null!=c?(q=c-b-10,0>q&&(q=c+10,q+b>e&&(q=e/2-b/2))):q=e/2-b/2;return this.el.css({left:d+"px",top:q+"px"})};c.prototype.show=function(){return this.el.show()};c.prototype.hide=function(){return this.el.hide()};return c}();b.Line=function(a){function c(a){this.hilight=h(this.hilight,this);this.onHoverOut=
h(this.onHoverOut,this);this.onHoverMove=h(this.onHoverMove,this);if(!(this instanceof b.Line))return new b.Line(a);c.__super__.constructor.call(this,a)}g(c,a);c.prototype.init=function(){this.pointGrow=Raphael.animation({r:this.options.pointSize+3},25,"linear");this.pointShrink=Raphael.animation({r:this.options.pointSize},25,"linear");if("always"!==this.options.hideHover)return this.hover=new b.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut)};c.prototype.defaults=
{lineWidth:3,pointSize:4,lineColors:"#0b62a4 #7A92A3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),pointWidths:[1],pointStrokeColors:["#ffffff"],pointFillColors:[],smooth:!0,xLabels:"auto",xLabelFormat:null,xLabelMargin:50,continuousLine:!0,hideHover:!1};c.prototype.calc=function(){this.calcPoints();return this.generatePaths()};c.prototype.calcPoints=function(){var a,c,b,d,e,f;e=this.data;f=[];b=0;for(d=e.length;b<d;b++)a=e[b],a._x=this.transX(a.x),a._y=function(){var b,d,e,n;e=a.y;n=[];b=0;
for(d=e.length;b<d;b++)c=e[b],null!=c?n.push(this.transY(c)):n.push(c);return n}.call(this),f.push(a._ymax=Math.min.apply(null,[this.bottom].concat(function(){var b,d,e,n;e=a._y;n=[];b=0;for(d=e.length;b<d;b++)c=e[b],null!=c&&n.push(c);return n}())));return f};c.prototype.hitTest=function(a,c){var b,d,e,f,l;if(0===this.data.length)return null;l=this.data.slice(1);b=e=0;for(f=l.length;e<f&&!(d=l[b],a<(d._x+this.data[b]._x)/2);b=++e);return b};c.prototype.onHoverMove=function(a,c){var b;b=this.hitTest(a,
c);return this.displayHoverForRow(b)};c.prototype.onHoverOut=function(){if("auto"===this.options.hideHover)return this.displayHoverForRow(null)};c.prototype.displayHoverForRow=function(a){var c;if(null!=a)return(c=this.hover).update.apply(c,this.hoverContentForRow(a)),this.hilight(a);this.hover.hide();return this.hilight()};c.prototype.hoverContentForRow=function(a){var c,b,d,e,f,l;b=this.data[a];if("function"===typeof this.options.hoverCallback)a=this.options.hoverCallback(a,this.options);else{a=
"<div class='morris-hover-row-label'>"+b.label+"</div>";l=b.y;c=e=0;for(f=l.length;e<f;c=++e)d=l[c],a+="<div class='morris-hover-point' style='color: "+this.colorFor(b,c,"label")+"'>\n  "+this.options.labels[c]+":\n  "+this.yLabelFormat(d)+"\n</div>"}return[a,b._x,b._ymax]};c.prototype.generatePaths=function(){var a,c,d,e,f;return this.paths=function(){var l,k,g,h;h=[];d=l=0;for(k=this.options.ykeys.length;0<=k?l<k:l>k;d=0<=k?++l:--l)f=!0===this.options.smooth||(g=this.options.ykeys[d],0<=m.call(this.options.smooth,
g)),c=function(){var a,c,b,s;b=this.data;s=[];a=0;for(c=b.length;a<c;a++)e=b[a],void 0!==e._y[d]&&s.push({x:e._x,y:e._y[d]});return s}.call(this),this.options.continuousLine&&(c=function(){var b,d,e;e=[];b=0;for(d=c.length;b<d;b++)a=c[b],null!==a.y&&e.push(a);return e}()),1<c.length?h.push(b.Line.createPath(c,f,this.bottom)):h.push(null);return h}.call(this)};c.prototype.draw=function(){this.options.axes&&this.drawXAxis();this.drawSeries();if(!1===this.options.hideHover)return this.displayHoverForRow(this.data.length-
1)};c.prototype.drawXAxis=function(){var a,c,d,e,f,l,k,g,h,r=this;l=this.bottom+1.25*this.options.gridTextSize;e=null;a=function(a,c){var b,d;b=r.drawXAxisLabel(r.transX(c),l,a);d=b.getBBox();return(null==e||e>=d.x+d.width)&&0<=d.x&&d.x+d.width<r.el.width()?e=d.x-r.options.xLabelMargin:b.remove()};d=this.options.parseTime?1===this.data.length&&"auto"===this.options.xLabels?[[this.data[0].label,this.data[0].x]]:b.labelSeries(this.xmin,this.xmax,this.width,this.options.xLabels,this.options.xLabelFormat):
function(){var a,c,b,d;b=this.data;d=[];a=0;for(c=b.length;a<c;a++)f=b[a],d.push([f.label,f.x]);return d}.call(this);d.reverse();h=[];k=0;for(g=d.length;k<g;k++)c=d[k],h.push(a(c[0],c[1]));return h};c.prototype.drawSeries=function(){var a,c,b,d,e,f;for(c=e=f=this.options.ykeys.length-1;0>=f?0>=e:0<=e;c=0>=f?++e:--e)b=this.paths[c],null!==b&&this.drawLinePath(b,this.colorFor(d,c,"line"));this.seriesPoints=function(){var a,b,d;d=[];c=a=0;for(b=this.options.ykeys.length;0<=b?a<b:a>b;c=0<=b?++a:--a)d.push([]);
return d}.call(this);f=[];for(c=b=e=this.options.ykeys.length-1;0>=e?0>=b:0<=b;c=0>=e?++b:--b)f.push(function(){var b,e,f,l;f=this.data;l=[];b=0;for(e=f.length;b<e;b++)d=f[b],a=null!=d._y[c]?this.drawLinePoint(d._x,d._y[c],this.options.pointSize,this.colorFor(d,c,"point"),c):null,l.push(this.seriesPoints[c].push(a));return l}.call(this));return f};c.createPath=function(a,c,d){var e,f,l,k,g,h,r,m,p,u;r="";c&&(l=b.Line.gradients(a));m={y:null};k=p=0;for(u=a.length;p<u;k=++p){e=a[k];if(null!=e.y)if(null!=
m.y)c?(f=l[k],h=l[k-1],g=(e.x-m.x)/4,k=m.x+g,h=Math.min(d,m.y+g*h),m=e.x-g,f=Math.min(d,e.y-g*f),r+="C"+k+","+h+","+m+","+f+","+e.x+","+e.y):r+="L"+e.x+","+e.y;else if(!c||null!=l[k])r+="M"+e.x+","+e.y;m=e}return r};c.gradients=function(a){var c,b,d,e,f,l,k;b=function(a,c){return(a.y-c.y)/(a.x-c.x)};k=[];d=f=0;for(l=a.length;f<l;d=++f)c=a[d],null!=c.y?(e=a[d+1]||{y:null},d=a[d-1]||{y:null},null!=d.y&&null!=e.y?k.push(b(d,e)):null!=d.y?k.push(b(d,c)):null!=e.y?k.push(b(c,e)):k.push(null)):k.push(null);
return k};c.prototype.hilight=function(a){var c,b,d;if(null!==this.prevHilight&&this.prevHilight!==a){c=b=0;for(d=this.seriesPoints.length-1;0<=d?b<=d:b>=d;c=0<=d?++b:--b)this.seriesPoints[c][this.prevHilight]&&this.seriesPoints[c][this.prevHilight].animate(this.pointShrink)}if(null!==a&&this.prevHilight!==a){c=b=0;for(d=this.seriesPoints.length-1;0<=d?b<=d:b>=d;c=0<=d?++b:--b)this.seriesPoints[c][a]&&this.seriesPoints[c][a].animate(this.pointGrow)}return this.prevHilight=a};c.prototype.colorFor=
function(a,c,b){return"function"===typeof this.options.lineColors?this.options.lineColors.call(this,a,c,b):"point"===b?this.options.pointFillColors[c%this.options.pointFillColors.length]||this.options.lineColors[c%this.options.lineColors.length]:this.options.lineColors[c%this.options.lineColors.length]};c.prototype.drawXAxisLabel=function(a,c,b){return this.raphael.text(a,c,b).attr("font-size",this.options.gridTextSize).attr("fill",this.options.gridTextColor)};c.prototype.drawLinePath=function(a,
c){return this.raphael.path(a).attr("stroke",c).attr("stroke-width",this.options.lineWidth)};c.prototype.drawLinePoint=function(a,c,b,d,e){return this.raphael.circle(a,c,b).attr("fill",d).attr("stroke-width",this.strokeWidthForSeries(e)).attr("stroke",this.strokeForSeries(e))};c.prototype.strokeWidthForSeries=function(a){return this.options.pointWidths[a%this.options.pointWidths.length]};c.prototype.strokeForSeries=function(a){return this.options.pointStrokeColors[a%this.options.pointStrokeColors.length]};
return c}(b.Grid);b.labelSeries=function(c,d,e,f,g){var n,h,w,y,m;n=200*(d-c)/e;e=new Date(c);f=b.LABEL_SPECS[f];if(void 0===f){m=b.AUTO_LABEL_ORDER;w=0;for(y=m.length;w<y;w++)if(h=m[w],h=b.LABEL_SPECS[h],n>=h.span){f=h;break}}void 0===f&&(f=b.LABEL_SPECS.second);g&&(f=a.extend({},f,{fmt:g}));g=f.start(e);for(e=[];(n=g.getTime())<=d;)n>=c&&e.push([f.fmt(g),n]),f.incr(g);return e};c=function(a){return{span:6E4*a,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours())},
fmt:function(a){return""+b.pad2(a.getHours())+":"+b.pad2(a.getMinutes())},incr:function(c){return c.setMinutes(c.getMinutes()+a)}}};d=function(a){return{span:1E3*a,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes())},fmt:function(a){return""+b.pad2(a.getHours())+":"+b.pad2(a.getMinutes())+":"+b.pad2(a.getSeconds())},incr:function(c){return c.setSeconds(c.getSeconds()+a)}}};b.LABEL_SPECS={decade:{span:1728E8,start:function(a){return new Date(a.getFullYear()-
a.getFullYear()%10,0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+10)}},year:{span:1728E7,start:function(a){return new Date(a.getFullYear(),0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+1)}},month:{span:24192E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},fmt:function(a){return""+a.getFullYear()+"-"+b.pad2(a.getMonth()+1)},incr:function(a){return a.setMonth(a.getMonth()+
1)}},day:{span:864E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return""+a.getFullYear()+"-"+b.pad2(a.getMonth()+1)+"-"+b.pad2(a.getDate())},incr:function(a){return a.setDate(a.getDate()+1)}},hour:c(60),"30min":c(30),"15min":c(15),"10min":c(10),"5min":c(5),minute:c(1),"30sec":d(30),"15sec":d(15),"10sec":d(10),"5sec":d(5),second:d(1)};b.AUTO_LABEL_ORDER="decade year month day hour 30min 15min 10min 5min minute 30sec 15sec 10sec 5sec second".split(" ");
b.Area=function(a){function c(a){if(!(this instanceof b.Area))return new b.Area(a);this.cumulative=!0;c.__super__.constructor.call(this,a)}g(c,a);c.prototype.calcPoints=function(){var a,c,b,d,e,f,g;f=this.data;g=[];d=0;for(e=f.length;d<e;d++){a=f[d];a._x=this.transX(a.x);c=0;for(var l=a,h=void 0,k=void 0,m=void 0,p=void 0,m=a.y,p=[],h=0,k=m.length;h<k;h++)b=m[h],c+=b||0,p.push(this.transY(c));l._y=p;g.push(a._ymax=a._y[a._y.length-1])}return g};c.prototype.drawSeries=function(){var a,b,d,e;for(a=
d=e=this.options.ykeys.length-1;0>=e?0>=d:0<=d;a=0>=e?++d:--d)b=this.paths[a],null!==b&&(b+="L"+this.transX(this.xmax)+","+this.bottom+"L"+this.transX(this.xmin)+","+this.bottom+"Z",this.drawFilledPath(b,this.fillForSeries(a)));return c.__super__.drawSeries.call(this)};c.prototype.fillForSeries=function(a){a=Raphael.rgb2hsl(this.colorFor(this.data[a],a,"line"));return Raphael.hsl(a.h,Math.min(255,0.75*a.s),Math.min(255,1.25*a.l))};c.prototype.drawFilledPath=function(a,c){return this.raphael.path(a).attr("fill",
c).attr("stroke-width",0)};return c}(b.Line);b.Bar=function(c){function d(c){this.onHoverOut=h(this.onHoverOut,this);this.onHoverMove=h(this.onHoverMove,this);if(!(this instanceof b.Bar))return new b.Bar(c);d.__super__.constructor.call(this,a.extend({},c,{parseTime:!1}))}g(d,c);d.prototype.init=function(){this.cumulative=this.options.stacked;if("always"!==this.options.hideHover)return this.hover=new b.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut)};
d.prototype.defaults={barSizeRatio:0.75,barGap:3,barColors:"#0b62a4 #7a92a3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),xLabelMargin:50};d.prototype.calc=function(){var a;this.calcBars();if(!1===this.options.hideHover)return(a=this.hover).update.apply(a,this.hoverContentForRow(this.data.length-1))};d.prototype.calcBars=function(){var a,c,b,d,e,f,g;f=this.data;g=[];a=d=0;for(e=f.length;d<e;a=++d)c=f[a],c._x=this.left+this.width*(a+0.5)/this.data.length,g.push(c._y=function(){var a,d,e,f;e=
c.y;f=[];a=0;for(d=e.length;a<d;a++)b=e[a],null!=b?f.push(this.transY(b)):f.push(null);return f}.call(this));return g};d.prototype.draw=function(){this.options.axes&&this.drawXAxis();return this.drawSeries()};d.prototype.drawXAxis=function(){var a,c,b,d,e,f,g;d=this.bottom+1.25*this.options.gridTextSize;b=null;g=[];a=e=0;for(f=this.data.length;0<=f?e<f:e>f;a=0<=f?++e:--e)a=this.data[this.data.length-1-a],a=this.drawXAxisLabel(a._x,d,a.label),c=a.getBBox(),(null==b||b>=c.x+c.width)&&0<=c.x&&c.x+c.width<
this.el.width()?g.push(b=c.x-this.options.xLabelMargin):g.push(a.remove());return g};d.prototype.drawSeries=function(){var a,c,b,d,e,f,g,l,h,k,m,p,u,x;b=this.width/this.options.data.length;l=null!=this.options.stacked?1:this.options.ykeys.length;a=(b*this.options.barSizeRatio-this.options.barGap*(l-1))/l;g=b*(1-this.options.barSizeRatio)/2;x=0>=this.ymin&&0<=this.ymax?this.transY(0):null;return this.bars=function(){var l,D,A,B;A=this.data;B=[];d=l=0;for(D=A.length;l<D;d=++l)h=A[d],e=0,B.push(function(){var l,
D,A,E;A=h._y;E=[];k=l=0;for(D=A.length;l<D;k=++l)u=A[k],null!==u?(x?(p=Math.min(u,x),c=Math.max(u,x)):(p=u,c=this.bottom),f=this.left+d*b+g,this.options.stacked||(f+=k*(a+this.options.barGap)),m=c-p,this.options.stacked&&(p-=e),this.drawBar(f,p,a,m,this.colorFor(h,k,"bar")),E.push(e+=m)):E.push(null);return E}.call(this));return B}.call(this)};d.prototype.colorFor=function(a,c,b){return"function"===typeof this.options.barColors?(a={x:a.x,y:a.y[c],label:a.label},c={index:c,key:this.options.ykeys[c],
label:this.options.labels[c]},this.options.barColors.call(this,a,c,b)):this.options.barColors[c%this.options.barColors.length]};d.prototype.hitTest=function(a,c){if(0===this.data.length)return null;a=Math.max(Math.min(a,this.right),this.left);return Math.min(this.data.length-1,Math.floor((a-this.left)/(this.width/this.data.length)))};d.prototype.onHoverMove=function(a,c){var b,d;b=this.hitTest(a,c);return(d=this.hover).update.apply(d,this.hoverContentForRow(b))};d.prototype.onHoverOut=function(){if("auto"===
this.options.hideHover)return this.hover.hide()};d.prototype.hoverContentForRow=function(a){var c,b,d,e,f,g,l;if("function"===typeof this.options.hoverCallback)c=this.options.hoverCallback(a,this.options);else{d=this.data[a];c="<div class='morris-hover-row-label'>"+d.label+"</div>";l=d.y;b=f=0;for(g=l.length;f<g;b=++f)e=l[b],c+="<div class='morris-hover-point'> <span class='label-1'><strong class='language' style='background-color: "+this.colorFor(d,b,"label")+"'>\n "+this.options.labels[b]+":\n </strong></span><span> "+
this.yLabelFormat(e)+"\n</span></div>"}return[c,this.left+(a+0.5)*this.width/this.data.length]};d.prototype.drawXAxisLabel=function(a,c,b){return this.raphael.text(a,c,b).attr("font-size",this.options.gridTextSize).attr("fill",this.options.gridTextColor)};d.prototype.drawBar=function(a,c,b,d,e){return this.raphael.rect(a,c,b,d).attr("fill",e).attr("stroke-width",0)};return d}(b.Grid);b.Donut=function(){function c(d){this.select=h(this.select,this);if(!(this instanceof b.Donut))return new b.Donut(d);
this.el="string"===typeof d.element?a(document.getElementById(d.element)):a(d.element);this.options=a.extend({},this.defaults,d);if(null===this.el||0===this.el.length)throw Error("Graph placeholder not found.");void 0===d.data||0===d.data.length||(this.data=d.data,this.redraw())}c.prototype.defaults={colors:"#0B62A4 #3980B5 #679DC6 #95BBD7 #B0CCE1 #095791 #095085 #083E67 #052C48 #042135".split(" "),backgroundColor:"#FFFFFF",labelColor:"#000000",valueColor:"#000000",formatter:b.commas};c.prototype.redraw=
function(){var a,c,d,e,f,g,h,k,m,t,r,z,p;this.el.empty();this.raphael=new Raphael(this.el[0]);c=this.el.width()/2;d=this.el.height()/2;t=(Math.min(c,d)-10)/3;m=0;k=this.data;a=0;for(h=k.length;a<h;a++)f=k[a],m+=f.value;h=5/(2*t);a=1.9999*Math.PI-h*this.data.length;f=g=0;this.segments=[];p=this.data;r=0;for(z=p.length;r<z;r++)e=p[r],k=g+h+a*(e.value/m),g=new b.DonutSegment(c,d,2*t,t,g,k,this.options.colors[f%this.options.colors.length],this.options.backgroundColor,e,this.raphael),g.render(),this.segments.push(g),
g.on("hover",this.select),g=k,f+=1;this.text1=this.drawEmptyDonutLabel(c,d-10,this.options.labelColor,15,800);this.text2=this.drawEmptyDonutLabel(c,d+10,this.options.valueColor,14,800);c=Math.max.apply(null,function(){var a,c,b,d;b=this.data;d=[];a=0;for(c=b.length;a<c;a++)e=b[a],d.push(e.value);return d}.call(this));f=0;t=this.data;a=[];d=0;for(m=t.length;d<m;d++){e=t[d];if(e.value===c){this.select(f);break}a.push(f+=1)}return a};c.prototype.select=function(a){var c,b,d,e;e=this.segments;b=0;for(d=
e.length;b<d;b++)c=e[b],c.deselect();a="number"===typeof a?this.segments[a]:a;a.select();return this.setLabels(a.data.label,this.options.formatter(a.data.value,a.data))};c.prototype.setLabels=function(a,c){var b,d,e,f;b=2*(Math.min(this.el.width()/2,this.el.height()/2)-10)/3;e=1.8*b;d=b/2;b/=3;this.text1.attr({text:a,transform:""});f=this.text1.getBBox();d=Math.min(e/f.width,d/f.height);this.text1.attr({transform:"S"+d+","+d+","+(f.x+f.width/2)+","+(f.y+f.height)});this.text2.attr({text:c,transform:""});
d=this.text2.getBBox();e=Math.min(e/d.width,b/d.height);return this.text2.attr({transform:"S"+e+","+e+","+(d.x+d.width/2)+","+d.y})};c.prototype.drawEmptyDonutLabel=function(a,c,b,d,e){a=this.raphael.text(a,c,"").attr("font-size",d).attr("fill",b);null!=e&&a.attr("font-weight",e);return a};return c}();b.DonutSegment=function(a){function c(a,b,d,e,f,g,k,l,m,r){this.cx=a;this.cy=b;this.inner=d;this.outer=e;this.color=k;this.backgroundColor=l;this.data=m;this.raphael=r;this.deselect=h(this.deselect,
this);this.select=h(this.select,this);this.sin_p0=Math.sin(f);this.cos_p0=Math.cos(f);this.sin_p1=Math.sin(g);this.cos_p1=Math.cos(g);this.is_long=g-f>Math.PI?1:0;this.path=this.calcSegment(this.inner+3,this.inner+this.outer-5);this.selectedPath=this.calcSegment(this.inner+3,this.inner+this.outer);this.hilight=this.calcArc(this.inner)}g(c,a);c.prototype.calcArcPoints=function(a){return[this.cx+a*this.sin_p0,this.cy+a*this.cos_p0,this.cx+a*this.sin_p1,this.cy+a*this.cos_p1]};c.prototype.calcSegment=
function(a,c){var b,d,e,f,g;f=this.calcArcPoints(a);b=f[0];e=f[1];d=f[2];f=f[3];g=this.calcArcPoints(c);return"M"+b+","+e+("A"+a+","+a+",0,"+this.is_long+",0,"+d+","+f)+("L"+g[2]+","+g[3])+("A"+c+","+c+",0,"+this.is_long+",1,"+g[0]+","+g[1])+"Z"};c.prototype.calcArc=function(a){var c;c=this.calcArcPoints(a);return"M"+c[0]+","+c[1]+("A"+a+","+a+",0,"+this.is_long+",0,"+c[2]+","+c[3])};c.prototype.render=function(){var a=this;this.arc=this.drawDonutArc(this.hilight,this.color);return this.seg=this.drawDonutSegment(this.path,
this.color,this.backgroundColor,function(){return a.fire("hover",a)})};c.prototype.drawDonutArc=function(a,c){return this.raphael.path(a).attr({stroke:c,"stroke-width":2,opacity:0})};c.prototype.drawDonutSegment=function(a,c,b,d){return this.raphael.path(a).attr({fill:c,stroke:b,"stroke-width":3}).hover(d)};c.prototype.select=function(){if(!this.selected)return this.seg.animate({path:this.selectedPath},150,"<>"),this.arc.animate({opacity:1},150,"<>"),this.selected=!0};c.prototype.deselect=function(){if(this.selected)return this.seg.animate({path:this.path},
150,"<>"),this.arc.animate({opacity:0},150,"<>"),this.selected=!1};return c}(b.EventEmitter)}).call(this);
(function(){var a={};this.tmpl=function c(d,e){var f=!/\W/.test(d)?a[d]=a[d]||c(document.getElementById(d).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+d.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return e?f(e):f}})();jQuery.extend(jQuery.ns("Kattis.API"),{ajax_session_edit:"/ajax/session",ajax_session_banner:"/ajax/session/banner",ajax_session_judge:"/ajax/session/judge",ajax_session_problem:"/ajax/session/problem",ajax_session_team:"/ajax/session/team",ajax_session_team_member:"/ajax/session/team/member",ajax_session_short_name_available:"/ajax/session/short-name-available",ajax_session_publish:"/ajax/session/publish",ajax_author:"/ajax/author",ajax_course_offering_teacher:"/ajax/course_offering/teacher",ajax_course_offering_short_name_available:"/ajax/course_offering/short-name-available",
user_view:"/users",problemgroup_edit:"/problemgroups/{0}/edit"});jQuery.extend(jQuery.ns("Kattis.util"),{isValidDate:function(a){var b=a.match(/^(\d\d\d\d)-(\d\d)-(\d\d)$/);if(null===b)return!1;a=parseInt(b[1]);var c=parseInt(b[2]),b=parseInt(b[3]);if(1970>a||2100<a||0==c||12<c)return!1;var d=[31,28,31,30,31,30,31,31,30,31,30,31];if(0==a%400||0!=a%100&&0==a%4)d[1]=29;return 0<b&&b<=d[c-1]},isValidTime:function(a){var b=a.match(/^(\d\d):(\d\d)(:(\d\d))?$/);if(null===b)return!1;a=parseInt(b[1]);var c=parseInt(b[2]),b=void 0===b[4]?null:parseInt(b[4]);return 24>a&&
60>c&&(null===b||60>b)}});jQuery.extend(jQuery.ns("Kattis.views.contest.edit"),{MAX_INT_32:Math.pow(2,31)-1,MAX_UNPRIVILEGED_DURATION:604800,init:function(){this.shortnameValid=this.timehintsValid=!0;this.btnCreateSession=jQuery("#create-btn");this.btnCreateSession.bind("click",this.createSession.bind(this));this.txtStartTime=jQuery("#start-time");this.spanStartHint=jQuery("#start-hint");this.startTimeVal=null;this.txtStartTime.bind("change keyup input",this.modifyTimeHints.bind(this));this.txtDuration=jQuery("#duration");
this.spanFinishHint=jQuery("#finish-hint");this.durationVal=null;this.txtDuration.bind("change keyup input",this.modifyTimeHints.bind(this));this.sessionNameHint=jQuery("#session-name-hint");(this.sessionNameValid=this.data.existing)||this.sessionNameHint.text("Name can't be empty");jQuery("#session-name").on("change keyup input",this.modifySessionNameHint.bind(this));this.data.is_privileged&&(this.txtCutoff=jQuery("#cutoff"),this.spanCutoffHint=jQuery("#cutoff-hint"),this.cutoffVal=null,this.txtCutoff.bind("change keyup input",
this.modifyTimeHints.bind(this)),this.txtShortName=jQuery("#short-name"),this.spanShortNameHint=jQuery("#short-name-hint"),this.txtShortName.bind("change keyup input",this.onContestShortNameChange.bind(this)),jQuery("#remove-banner").bind("click",this.onRemoveBannerClick.bind(this)));if(this.data.existing){this.btnPublishSession=jQuery("#publish-btn");this.spanPublishProgress=jQuery("#publish-progress");this.btnPublishSession.bind("click",this.publishSession.bind(this));jQuery("#basic-settings").on("change input",
":input",this.onBasicSettingChange.bind(this));jQuery("#tblProblems").on("mousedown mouseup",".dndhandle",function(){jQuery(this).toggleClass("grab grabbing")});jQuery("#add-problem-btn").bind("click",this.onAddProblem.bind(this));jQuery("#add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").bind("change keyup input",this.onProblemNameAvalabilityChange.bind(this));jQuery("#add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").keypress(function(a){13==
a.keyCode&&!jQuery("#add-problem-btn").prop("disabled")&&jQuery("#add-problem-btn").click()});this.resetProblems();this.setUpProblemsSorting();this.data.is_privileged&&(this.tbodyJudge=jQuery("#tblJudges tbody"),this.judge_tmpl=tmpl("judge_tmpl"),jQuery("#add-judge-btn").bind("click",this.onAddJudge.bind(this)),jQuery("#add-judge-username").bind("change keyup input",function(){jQuery("#add-judge-btn").prop("disabled",""===jQuery(this).val())}),jQuery("#add-judge-username").keypress(function(a){13==
a.keyCode&&!jQuery("#add-judge-btn").prop("disabled")&&jQuery("#add-judge-btn").click()}),this.data.judges.forEach(this.addJudgeRow,this));this.tbodyTeam=jQuery("#tblTeams tbody");this.team_tmpl=tmpl("team_tmpl");this.team_member_tmpl=tmpl("team_member_tmpl");this.autoaccept=!1;this.tbodyTeam.on("click","input.team-member-accepted",function(a){this.autoaccept=jQuery(a.target).is(":checked");this.tbodyTeam.find("input.team-member-accepted").prop("checked",this.autoaccept)}.bind(this));jQuery("#add-team-btn").bind("click",
this.onAddTeam.bind(this));jQuery("#add-team-name"+(this.data.is_privileged?", #add-team-penalty":"")).keyup(function(a){13==a.keyCode&&!jQuery("#add-team-btn").prop("disabled")&&jQuery("#add-team-btn").click()});jQuery(document).on("focusin",function(a){var b=a.target;jQuery("#tblTeams tbody tr").has(".team-edit:hidden").each(function(){jQuery(this).has(b).length||jQuery(this).find(".team-done").click()})});this.data.teams.forEach(this.addTeamRow,this);var a=this,b=jQuery("#add-problem-available-from");
jQuery(".enable-add-problem-popover").popover({placement:"top",html:!0,container:"body",content:'<input type="text" class="form-control problem-available-date">'}).on("show.bs.popover",function(){b.prop("disabled",!0)}).on("hide.bs.popover",function(){b.prop("disabled",!1)}).on("shown.bs.popover",function(){var c=a.getTimeFromString(a.startTimeVal),d=b.val().split(":"),e=d[1],d=d[0],f=jQuery(".problem-available-date");null!==c&&(e=new Date(c.getTime()+6E4*e+36E5*d),f.val(a.getTimeStringFromDateObject(e)));
f.on("change keyup paste",function(){if(null!==c){var d=a.getTimeFromString(f.val());null!==d&&(d-=c,0<=d&&b.val(parseInt(d/36E5)+":"+a.leftBinPad(parseInt(d/6E4)%60)))}})})}this.modifyTimeHints();jQuery("body").on("hidden.bs.popover",function(a){jQuery(a.target).data("bs.popover").inState.click=!1})},leftBinPad:function(a){return 10>a?"0"+a:a},getTimeStringFromDateObject:function(a){var b=this.leftBinPad;return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+" "+b(a.getUTCHours())+
":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())},modifySessionNameHint:function(a){""===jQuery(a.target).val().trim()?(this.sessionNameHint.text("Name can't be empty"),this.sessionNameValid=!1):(this.sessionNameHint.text(""),this.sessionNameValid=!0);this.updateSaveButton()},isValid:function(){return this.timehintsValid&&this.shortnameValid&&this.sessionNameValid},updateSaveButton:function(a){a=void 0===a?this.isValid():a;this.btnCreateSession.prop("disabled",!a);this.data.existing&&(a?jQuery("#unsaved-changes").removeClass("hidden"):
jQuery("#unsaved-changes").addClass("hidden"))},onBasicSettingChange:function(a){jQuery(a.target).closest("div.form-group").addClass("has-warning");this.updateSaveButton()},onProblemNameAvalabilityChange:function(){var a=!0;""===jQuery("#add-problem-name").val()&&(a=!1);this.data.is_privileged&&null===this.parse_formatted_interval(jQuery("#add-problem-available-from").val())&&(a=!1);jQuery("#add-problem-btn").prop("disabled",!a)},setUpProblemsSorting:function(){jQuery("#tblProblems tbody").sortable({handle:"> .dndhandle",
items:"> tr",helper:function(a,b){b.parent().children().children().each(function(){jQuery(this).width(jQuery(this).width())});return b},update:function(a,b){var c={short_name:this.data.short_name,problem_name:b.item.attr("data-name"),index:b.item.index(),csrf_token:this.data.csrf_token};jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_problem,contentType:"application/json",data:JSON.stringify(c),context:this}).done(function(a){this.replaceProblems(a.response.problems)}).fail(function(a){var c=
b.item.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code);this.resetProblems()})}.bind(this)})},onContestShortNameChange:function(){this.call_id=(this.call_id||0)+1;this.hintTimeout&&(clearTimeout(this.hintTimeout),this.hintTimeout=null);this.data.short_name===this.txtShortName.val()?(this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin").addClass("glyphicon glyphicon-ok text-success"),this.data.existing&&
this.btnPublishSession.prop("disabled",!1),this.shortnameValid=!0,this.updateSaveButton()):""===this.txtShortName.val()?(this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin"),this.shortnameValid=!0,this.updateSaveButton()):(this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin").addClass("fa fa-spinner fa-spin"),this.updateSaveButton(!1),this.data.existing&&
this.btnPublishSession.prop("disabled",!0),this.hintTimeout=setTimeout(function(a){jQuery.ajax({type:"GET",url:Kattis.API.ajax_session_short_name_available,data:{name:this.txtShortName.val()},context:this}).always(function(){this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin")}).done(function(b){a===this.call_id&&(this.shortnameValid=b.response.available,this.spanShortNameHint.addClass(this.shortnameValid?"glyphicon glyphicon-ok text-success":
"glyphicon glyphicon-remove text-danger"),this.updateSaveButton())}).fail(function(){a===this.call_id&&(this.shortnameValid=!1,this.spanShortNameHint.addClass("glyphicon glyphicon-remove text-danger"),this.updateSaveButton())})}.bind(this),750,this.call_id))},problem_tmpl:function(a){var b=tmpl("problem_tmpl");a.format_minutes=this.format_minutes;return b(a)},onAddProblem:function(a){var b=jQuery(a.target);jQuery("#add-problem-btn, #add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").prop("disabled",
!0);a={short_name:this.data.short_name,problem_name:jQuery("#add-problem-name").val(),color_name:jQuery("#add-problem-color-name").val(),rgb:jQuery("#add-problem-color-rgb").val(),csrf_token:this.data.csrf_token};this.data.is_privileged&&(a.available_in_session_from=this.parse_formatted_interval(jQuery("#add-problem-available-from").val()));jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_problem,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){jQuery("#add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").prop("disabled",
!1);jQuery("#add-problem-name").focus();jQuery(".enable-add-problem-popover").popover("hide")}).done(function(a){jQuery("#add-problem-name").val("");jQuery("#add-problem-available-from").val("0:00");jQuery("#add-problem-color-name").val("");jQuery("#add-problem-color-rgb").val("");this.replaceProblems(a.response.problems)}).fail(function(a){b.prop("disabled",!1);var d=b.data("fail-msg");Kattis.error.show_msg(d+": ",a.responseJSON.error.code)})},onAddJudge:function(a){var b=jQuery(a.target);0<this.tbodyJudge.find("[data-username='"+
jQuery("#add-judge-username").val()+"']").length?alert(b.attr("data-nonunique-msg")):(b.prop("disabled",!0),a={short_name:this.data.short_name,username:jQuery("#add-judge-username").val(),may_clarify:jQuery("#add-judge-may-clarify").is(":checked"),csrf_token:this.data.csrf_token},jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_judge,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){jQuery("#add-judge-username").focus()}).done(function(a){jQuery("#add-judge-username").val("");
jQuery("#add-judge-may-clarify").prop("checked",!0);this.addJudgeRow(a.response,!0)}).fail(function(a){b.prop("disabled",!1);var d=b.data("fail-msg");Kattis.error.show_msg(d+": ",a.responseJSON.error.code)}))},onAddTeam:function(a){var b=jQuery(a.target),c=b.closest("tr").find(":input");c.prop("disabled",!0);a={short_name:this.data.short_name,team_name:jQuery("#add-team-name").val(),csrf_token:this.data.csrf_token};this.data.is_privileged&&(a.penalty_adjustment=jQuery("#add-team-penalty").val());
jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_team,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){c.prop("disabled",!1)}).done(function(a){jQuery("#add-team-name").val("");this.data.is_privileged&&jQuery("#add-team-penalty").val(0);this.addTeamRow(a.response.team,!0,!0)}).fail(function(a){var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},onRemoveBannerClick:function(a){var b=jQuery(a.target);b.prop("disabled",!0);jQuery.ajax({type:"DELETE",
url:Kattis.API.ajax_session_banner,contentType:"application/json",data:JSON.stringify({short_name:this.data.short_name,csrf_token:this.data.csrf_token})}).always(function(){b.prop("disabled",!1)}).done(function(){b.hide();jQuery("#session_banner").remove()}).fail(function(a){var d=b.data("fail-msg");Kattis.error.show_msg(d+": ",a.responseJSON.error.code)})},createSession:function(){this.btnCreateSession.prop("disabled",!0);var a=this.getSessionTimeUTC();if(null!==a){var b={session_name:jQuery("#session-name").val().trim(),
start_time:a.toISOString(),duration:this.parse_formatted_interval(this.txtDuration.val()),is_open:jQuery("#is-open").is(":checked"),session_abbreviated_name:jQuery("#session-abbreviated-name").val(),csrf_token:this.data.csrf_token};this.data.existing&&jQuery.extend(b,{old_short_name:this.data.short_name});this.data.is_privileged&&jQuery.extend(b,{cutoff:this.parse_formatted_interval(this.txtCutoff.val()),short_name:this.txtShortName.val(),is_ranked:jQuery("#is-ranked").is(":checked"),show_first_to_solve:jQuery("#show-first-to-solve").is(":checked"),
show_group_leaders:jQuery("#show-group-leaders").is(":checked"),show_flags:jQuery("#show-flags").is(":checked"),show_logos:jQuery("#show-logos").is(":checked"),submission_penalty:jQuery("#submission-penalty").val(),scoreboard_limit:jQuery("#scoreboard-limit").val(),scoreboard_submission_threshold:jQuery("#scoreboard-submission-threshold").val(),scoreboard_solved_threshold:jQuery("#scoreboard-solved-threshold").val(),timestep_in_seconds:jQuery("#timestep-in-seconds").val(),autofinalize:jQuery("#autofinalize").is(":checked"),
classification:jQuery("#classification").val()});if(this.data.is_privileged)if(b.banner_image=null,a=document.getElementById("banner-image"),a.files&&a.files[0]){var c=new FileReader;c.onload=function(a){b.banner_image=btoa(a.target.result);this.internalCreateSession(b)}.bind(this);c.readAsBinaryString(a.files[0])}else this.internalCreateSession(b);else this.internalCreateSession(b)}},internalCreateSession:function(a){jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_edit,contentType:"application/json",
data:JSON.stringify(a),context:this}).always(function(){this.btnCreateSession.prop("disabled",!1)}).done(function(a){window.location.replace(a.response.redirect)}).fail(function(a){var c=this.btnCreateSession.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},publishSession:function(){confirm("Are you sure you want to publish? Publishing cannot be undone.")&&(this.btnPublishSession.prop("disabled",!0),this.spanPublishProgress.html('<i class="fa fa-spinner fa-spin"></i>'),
jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_publish,contentType:"application/json",data:JSON.stringify({csrf_token:this.data.csrf_token,short_name:this.data.short_name}),context:this}).done(function(){this.spanPublishProgress.html('<i class="glyphicon glyphicon-ok"></i>');window.location.reload(!0)}).fail(function(a){this.spanPublishProgress.html('<i class="glyphicon glyphicon-remove"></i>');this.btnPublishSession.prop("disabled",!1);var b=this.btnPublishSession.data("fail-msg");Kattis.error.show_msg(b+
": ",a.responseJSON.error.code)}))},getTimeFromString:function(a){if(!/^\d\d\d\d-\d\d-\d\d \d\d:\d\d(:\d\d)?$/.test(a))return null;var b=a.split(" ");a=b[0];b=b[1];return!Kattis.util.isValidDate(a)||!Kattis.util.isValidTime(b)?null:new Date(a+"T"+b+"Z")},getSessionTimeUTC:function(){return this.getTimeFromString(this.txtStartTime.val())},isInt:function(a){return!isNaN(a)&&parseInt(Number(a))==a&&!isNaN(parseInt(a,10))},parse_formatted_minutes:function(a){var b=a.split(":");if(2!==b.length)return null;
a=b[0];b=b[1];if(!this.isInt(a)||!this.isInt(b)||!a.match(/^\d+$/)||!b.match(/^\d\d$/))return null;a=parseInt(a,10);b=parseInt(b,10);return 0>a||0>b||60<=b?null:60*a+b},parse_formatted_interval:function(a){if(!/^\d+:\d\d(:\d\d)?$/.test(a))return null;var b=a.split(":");if(2===b.length)return b=this.parse_formatted_minutes(a),null===b||60*b>this.MAX_INT_32?null:60*b;a=this.parse_formatted_minutes([b[0],b[1]].join(":"));b=b[2];if(null===a||!this.isInt(b))return null;b=parseInt(b,10);if(0>b||60<=b)return null;
b=60*a+b;return b>this.MAX_INT_32?null:b},format_minutes:function(a){a=Math.floor(a);return Math.floor(a/60)+":"+twodigit(a%60)},areTimeFieldsChanged:function(){return this.startTimeVal!==this.txtStartTime.val()||this.durationVal!==this.txtDuration.val()||this.data.is_privileged&&this.cutoffVal!==this.txtCutoff.val()?!0:!1},validateStartTime:function(){var a=this.getSessionTimeUTC();if(null===a)return this.spanStartHint.text("Invalid start time"),this.spanFinishHint.text("Invalid start time"),this.data.is_privileged&&
this.spanCutoffHint.text("Invalid start time"),!1;this.spanStartHint.text(a.toString());return!0},validateDuration:function(){var a=this.parse_formatted_interval(this.txtDuration.val());if(null===a)return this.spanFinishHint.text("Invalid duration"),this.data.is_privileged&&this.spanCutoffHint.text("Invalid duration"),!1;if(!this.data.is_privileged&&a>this.MAX_UNPRIVILEGED_DURATION)return this.spanFinishHint.text("Maximal duration is limited to 168 hours"),!1;var b=this.getSessionTimeUTC(),a=new Date(b.getTime()+
1E3*a);this.spanFinishHint.text(a.toString());return!0},validateCutoff:function(){if(!this.data.is_privileged)return!0;var a=this.parse_formatted_interval(this.txtDuration.val()),b=this.parse_formatted_interval(this.txtCutoff.val());if(null===b||b>a)return this.spanCutoffHint.text("Invalid cutoff"),!1;if(0===b)this.spanCutoffHint.text("None");else{var c=this.getSessionTimeUTC(),a=new Date(c.getTime()+1E3*a),b=new Date(a.getTime()-1E3*b);this.spanCutoffHint.text(b.toString())}return!0},modifyTimeHints:function(){this.areTimeFieldsChanged()&&
(this.timehintsValid=!0,this.startTimeVal=this.txtStartTime.val(),this.durationVal=this.txtDuration.val(),this.data.is_privileged&&(this.cutoffVal=this.txtCutoff.val()),[this.validateStartTime,this.validateDuration,this.validateCutoff].forEach(function(a){this.timehintsValid&&(this.timehintsValid=a.call(this))},this),this.data.existing||this.updateSaveButton())},addProblemRow:function(a,b){var c=jQuery(this.problem_tmpl(a)),d=b?c.children("td").children("div"):jQuery();c.find(".problem-remove").bind("click",
this.removeProblem.bind(this));d.attr("style","display: none;");jQuery("#tblProblems tbody").append(c);d.slideDown("fast")},removeProblem:function(a){var b=jQuery(a.target);a=b.closest("tr");var c=b.closest("tr").find(":input");c.prop("disabled",!0);a={short_name:this.data.short_name,problem_name:a.attr("data-name"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_session_problem,contentType:"application/json",data:JSON.stringify(a),context:this}).done(function(a){this.replaceProblems(a.response.problems)}).fail(function(a){c.prop("disabled",
!1);var e=b.data("fail-msg");Kattis.error.show_msg(e+": ",a.responseJSON.error.code);this.resetProblems()})},resetProblems:function(){jQuery("#tblProblems tbody").empty();this.data.selected_problems.forEach(this.addProblemRow,this);var a=jQuery(this.data.all_problem_names).not(jQuery.map(this.data.selected_problems,function(a){return a.name})).get();jQuery("#problems").replaceWith(jQuery('<datalist id="problems" />').append(jQuery.map(a,function(a){return jQuery("<option />").attr("value",a)})))},
replaceProblems:function(a){this.data.selected_problems=a;this.resetProblems()},addJudgeRow:function(a,b){var c=jQuery(this.judge_tmpl(a)),d=b?c.children("td").children("div"):jQuery();c.find(".judge-remove").bind("click",this.removeJudge.bind(this));c.find(".judge-may-clarify").bind("change",this.updateJudge.bind(this));d.attr("style","display: none;");this.tbodyJudge.append(c);d.slideDown("fast")},removeJudge:function(a){var b=jQuery(a.target);b.prop("disabled",!0);var c=b.closest("tr");a={short_name:this.data.short_name,
username:c.attr("data-username"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_session_judge,contentType:"application/json",data:JSON.stringify(a),context:this}).done(function(){c.children("td").children("div").slideUp("fast",function(){c.remove()})}).fail(function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},updateJudge:function(a){var b=jQuery(a.target);b.prop("disabled",!0);var c=b.closest("tr");a=
{short_name:this.data.short_name,username:c.attr("data-username"),may_clarify:c.find(".judge-may-clarify").is(":checked"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_judge,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){b.prop("disabled",!1)}).done(function(a){c.find(".judge-username a").text(a.username).attr("href",a.profile_url);c.find(".judge-name").text(a.name);c.find(".judge-may-clarify").prop("checked",a.may_clarify)}).fail(function(a){var c=
b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},addTeamRow:function(a,b,c){var d=tmpl("team_tmpl"),e=tmpl("team_member_tmpl"),f=jQuery(d(a));a.members.forEach(function(a){var c=jQuery(e(a));c.find(".team-member-remove").bind("click",this.removeTeamMember.bind(this));f.find("li.team-member-add").before(c);a.accepted||(!0===b?jQuery("#pending-invitation-info").slideDown("fast"):jQuery("#pending-invitation-info").show())},this);!0===c?f.find(".show-no-edit").hide():f.find(".show-edit").hide();
f.find(".team-member-accepted").prop("checked",this.autoaccept);f.find(".team-edit").bind("click",function(){jQuery(this).closest("tr").find(".show-edit, .show-no-edit").toggle()});f.find(".team-done").bind("click",this.updateTeam.bind(this));f.find(".team-name").keypress(function(a){var c=f.find("button.team-done");13===a.keyCode&&!c.prop("disabled")&&c.click()});f.find(".team-remove").bind("click",this.removeTeam.bind(this));f.find("button.team-member-add").bind("click",this.onAddTeamMember.bind(this));
f.find("input.team-member-username").bind("change keyup input",function(){f.find("button.team-member-add").prop("disabled",""===jQuery(this).val())});f.find("input.team-member-username").keyup(function(a){var c=f.find("button.team-member-add");13==a.keyCode&&!c.prop("disabled")&&c.click()});this.tbodyTeam.append(f);!0===c&&f.find(".team-member-username").focus()},onAddTeamMember:function(a){var b=jQuery(a.target),c=b.closest("li");b.prop("disabled",!0);var d=b.closest("tr");a={team_id:d.attr("data-team-id"),
username:c.find("input.team-member-username").val(),accepted:this.autoaccept,csrf_token:this.data.csrf_token};jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_team_member,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){d.find("input.team-member-username").focus()}).done(function(a){a=jQuery(this.team_member_tmpl(a.response.team_member));a.find(".team-member-remove").bind("click",this.removeTeamMember.bind(this));c.before(a);d.find("input.team-member-username").val("");
a.accepted||jQuery("#pending-invitation-info").slideDown("fast")}).fail(function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},removeTeam:function(a){var b=jQuery(a.target),c=b.closest("tr"),d=c.find(":input");d.prop("disabled",!0);a={short_name:this.data.short_name,team_id:c.attr("data-team-id"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_session_team,contentType:"application/json",data:JSON.stringify(a),
context:this}).done(function(){c.children("td").children("div").slideUp("fast",function(){c.remove()});jQuery('[data-invitation-state="pending"]').length||jQuery("#pending-invitation-info").slideUp("fast")}).fail(function(a){d.prop("disabled",!1);c.find("button.team-member-add").prop("disabled",""==c.find(".team-member-username").val());var f=b.data("fail-msg");Kattis.error.show_msg(f+": ",a.responseJSON.error.code)})},updateTeam:function(a){var b=jQuery(a.target),c=b.closest("tr"),d=c.find(":input");
d.prop("disabled",!0);a={short_name:this.data.short_name,team_id:c.attr("data-team-id"),team_name:c.find("input.team-name").val(),csrf_token:this.data.csrf_token};this.data.is_privileged&&(a.penalty_adjustment=c.find("input.team-penalty").val());jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_team,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){d.prop("disabled",!1);c.find("button.team-member-add").prop("disabled",""==c.find(".team-member-username").val());
c.find(".show-edit, .show-no-edit").toggle()}).done(function(a){a=a.response.team;c.find("input.team-name").val(a.team_name);c.find("span.team-name").text(a.team_name);this.data.is_privileged&&(c.find("input.team-penalty").val(a.penalty_adjustment),c.find("span.team-penalty").text(a.penalty_adjustment))}).fail(function(a){var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},removeTeamMember:function(a){var b=jQuery(a.target);b.prop("disabled",!0);var c=b.closest("li");
a={team_id:b.closest("tr").attr("data-team-id"),username:c.attr("data-username"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_session_team_member,contentType:"application/json",data:JSON.stringify(a),context:this}).done(function(){c.remove();jQuery('[data-invitation-state="pending"]').length||jQuery("#pending-invitation-info").slideUp("fast")}).fail(function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})}});jQuery.extend(jQuery.ns("Kattis.views.contest.resolver"),{init:function(){var a=this.data,b=a.info,c=b.length,d=b.cutoff;jQuery(function(b){function f(a){return b(v.document.getElementById(a))}function g(){b(".team_problem_cell").css("width",f("resolver_cell_width").val()+"px")}function h(a,c){b("html, body").stop().animate({scrollTop:a.offset().top-b(window).height()/2+a.height()/2},200,function(){c&&c()})}function m(a,f){for(var g=b(C({team:a,problems:f})),h=g.children(".rank"),k=g.children(".score"),
l=g.children(".time"),m=g.children(".team_problem_cell"),q={},n=0;n<f.length;n++)q[f[n].id]={cell:b(m[n]),score:0,submissions:0,pending:[],last_improvement:0,max_score:f[n].max_score};return{id:a.id,name:a.name,row:g,cur_row:g,no_cell:h,points_cell:k,time_cell:l,problems:q,points:0,get_last_improvement:function(){for(var a=0,c=0;c<w.length;c++)a=Math.max(a,this.problems[w[c]].last_improvement);return a},reset:function(){this.no_cell.text("");this.points_cell.text("0");this.time_cell.text("0");for(var a=
this.points=0;a<w.length;a++){var c=w[a];this.problems[c].score=0;this.problems[c].submissions=0;this.problems[c].last_improvement=0;this.problems[c].pending=[];this.problems[c].cell.empty();this.problems[c].cell.removeClass("solved attempted partial-score pending")}},handle_submission:function(a,b,e){if(!a.judged)return!1;var f=this.problems[a.problem];if("CE"===a.result||1E-9>Math.abs(f.score-f.max_score))return!1;var g=a.time>=(c-d)/60;if(!g||b)f.submissions++,this.points-=f.score,a.score>f.score+
1E-9?(f.score=a.score,f.last_improvement=Math.floor(a.time)):1E-9>Math.abs(a.score-f.score)&&(f.last_improvement=Math.min(f.last_improvement,Math.floor(a.time))),this.points+=f.score;if(g)if(b){for(b=0;b<f.pending.length&&f.pending[b]!==a;)b++;b<f.pending.length&&(f.pending[b]=f.pending[f.pending.length-1],f.pending.pop());f.pending.sort(function(a,c){return c.time-a.time})}else f.pending.push(a);e||(this.points_cell.text(this.points),this.time_cell.text(this.get_last_improvement()),f.cell.html(f.score+
"<br/>"+f.submissions+(0<f.pending.length?"+"+f.pending.length:"")),f.cell.removeClass("solved attempted partial-score pending"),1E-9>Math.abs(f.score-f.max_score)?f.cell.addClass("solved"):0<f.pending.length?f.cell.addClass("pending"):0===f.score?f.cell.addClass("attempted"):f.cell.addClass("partial-score"));return!0}}}function k(a,c,d,f,g,h){for(var k=f.offset(),l=f.height(),m=f.width(),n=[],p=0;2>p;p++)n.push(b("<tr></tr>").append(b("<td></td>",{colspan:4+q.length}).css({height:"0",margin:"0",
padding:"0"})));n[0].height(0).width(m);f.replaceWith(n[1]);a.cur_row=n[1];n[1].height(l).width(m);f.height(l).width(m);var t=b("<div></div>");t.append(b("<table></table>").addClass("table table-kattis kattis-table-contest-standings").css({"border-top":"none","border-radius":"none"}).append(b("<tbody></tbody>").append(f))).width(m).height(l).css({position:"absolute",top:k.top+"px",left:k.left+1+"px"}).appendTo(b("#wrapper"));0===g?n[0].prependTo(b("#standings tbody")):n[0].insertAfter(d[g-1].row);
a.cur_row=n[0];n[1].animate({height:"0"},c);n[0].animate({height:l},c);t.animate({top:n[0].offset().top+"px"},c,function(){f.width("auto").height("auto");n[0].replaceWith(f);a.cur_row=f;t.remove();n[1].remove();h&&h()})}function l(a,c,d){a.sort(function(a,c){if(a.points!==c.points)return c.points-a.points;var b=a.get_last_improvement(),d=c.get_last_improvement();return 1E-9<Math.abs(b-d)?b-d:a.name!==c.name?a.name.localeCompare(c.name):0});var g=0;(function B(){if(g===a.length)d&&d();else{var h=a[g].row.index()+
1,l=g+1;0<a[g].points?a[g].no_cell.text(l):a[g].no_cell.text("");l<h?c?(h=parseInt(f("resolver_row_animate_time").val(),10)*(Math.abs(l-h)+1),k(a[g],h,a,a[g].row,l-1,function(){g+=1;B()})):(a[g].row.detach(),1===l?a[g].row.prependTo(b("#standings tbody")):a[g].row.insertAfter(a[g-1].row),g+=1,B()):(g+=1,B())}})()}var v=window.open("","Kattis Resolver","width=450, height=400");v.document.open();v.document.write(b("#resolver_controls_wrapper").html());v.document.title="Controls";f("resolver_cell_width").change(g);
var s=tmpl("table_header_tmpl"),C=tmpl("team_row_tmpl"),n=s({all_captions:!0,problems:a.problems});b("#standings thead").append(n);for(var q=a.problems,w=[],n=0;n<a.problems.length;n++)w.push(a.problems[n].id);for(var y={},F=[],t=[],n=0;n<a.teams.length;n++){var r=new m(a.teams[n],q);y[r.id]=r;F.push(r.id);b("#standings tbody").append(r.row);t.push(r)}b("#standings tbody").append(s({all_captions:!1,problems:a.problems}));s=a.runs;s.sort(function(a,c){return a.time-c.time});for(var z=[],n=0;n<s.length;n++)r=
y[s[n].team],y[s[n].team].handle_submission(s[n],!0,!0)&&z.push(s[n]);var p=function(a){function c(){for(var a=0;a<s.length;a++)f(s[a]).prop("disabled",!0).css("color","gray")}function d(){var c={};0<g&&!r&&(c.resolver_reset=!0);g<a.length&&(r?c.resolver_playback_pause=!0:(c.resolver_playback_step=!0,c.resolver_playback_play=!0,c.resolver_playback_skip=!0));g>=a.length&&0<=k&&(r?c.resolver_resolve_pause=!0:(c.resolver_resolve_step=!0,c.resolver_resolve_play=!0));for(var b=0;b<s.length;b++){var e=
c.hasOwnProperty(s[b]);f(s[b]).prop("disabled",!e).css("color",e?"black":"gray")}}var g=0,k=t.length-1,m=0,n=!1,p=!1,r=!1,s="resolver_reset resolver_playback_step resolver_playback_play resolver_playback_pause resolver_playback_skip resolver_resolve_step resolver_resolve_play resolver_resolve_pause".split(" ");return{reset:function(){g=0;k=t.length-1;problem_at=0;b("#standings tr").removeClass("highlight");b("#standings td").removeClass("resolve-problem");p=n=!1;c();for(var a=0;a<F.length;a++)y[F[a]].reset();
l(t,!1,d)},playback_step:function(){c();var b=a[g];y[b.team].handle_submission(b,!1);g++;l(t,!0,d)},playback_skip:function(){for(c();g<a.length;){var b=a[g];y[b.team].handle_submission(b,!1);g++}l(t,!1,d)},playback_play:function(){function b(){n||(h.playback_stop=null,r=!1,d())}function e(){return 6E4*(a[g].time-(0===g?0:a[g-1].time))*parseFloat(f("resolver_time_multiplier").val())}function k(){if(m){var c=a[g];y[c.team].handle_submission(c,!1);g++;n=!0;l(t,!0,function(){n=!1;g<a.length&&m?p=setTimeout(k,
e()):b()})}else b()}r=!0;var h=this,m=!0,n=!1,p=null;this.playback_pause=function(){m=!1;c();clearTimeout(p);b()};p=setTimeout(k,e());d()},resolve_step:function(a,b){function e(){a||d();b&&b()}a||c();if(n)if(p){for(var f=t[k].problems[w[m]],g=f.score,r=-1,s=0;s<f.pending.length;s++)if(f.pending[s].score>g&&(0>r||f.pending[s].score<r))r=f.pending[s].score;r=Math.max(r,0);a:for(;;){for(s=0;s<f.pending.length;s++)if(f.pending[s].score<=r){t[k].handle_submission(f.pending[s],!0);continue a}break}var u=
t[k].row;t[k].problems[w[m]].cell.removeClass("resolve-problem");h(t[k].row);l(t,!0,function(){u.removeClass("highlight");n=!0;p=!1;m=0;t[k].row.addClass("highlight");e()})}else{for(;m<q.length&&!(0<t[k].problems[w[m]].pending.length);)m++;m<q.length?(t[k].problems[w[m]].cell.addClass("resolve-problem"),p=!0):(t[k].row.removeClass("highlight"),k--,m=0,0<=k&&(t[k].row.addClass("highlight"),n=!0,p=!1));0<=k&&h(t[k].row);e()}else t[k].row.addClass("highlight"),h(t[k].row),n=!0,e()},resolve_play:function(a){function b(){l||
(g.resolve_stop=null,r=!1,d())}function e(){h?(l=!0,g.resolve_step(!0,function(){l=!1;k>=a?m=setTimeout(e,parseInt(f("resolver_resolve_timestep").val(),10)):b()})):b()}if(!(k<a)){r=!0;var g=this,h=!0,l=!1,m=null;this.resolve_pause=function(){h=!1;c();clearTimeout(m);b()};d();e()}}}}(z);p.reset();f("resolver_controls").submit(function(){return!1});f("resolver_reset").click(function(){p.reset()});f("resolver_playback_step").click(function(){p.playback_step()});f("resolver_playback_play").click(function(){p.playback_play()});
f("resolver_playback_pause").click(function(){p.playback_pause()});f("resolver_playback_skip").click(function(){p.playback_skip()});f("resolver_resolve_step").click(function(){p.resolve_step()});f("resolver_resolve_play").click(function(){p.resolve_play(parseInt(f("resolver_resolve_play_upto").val(),10))});f("resolver_resolve_pause").click(function(){p.resolve_pause()});b(v.document).on("keydown",function(a){var c=[];39===a.keyCode?c=["resolver_playback_step","resolver_resolve_step"]:32===a.keyCode&&
(c=["resolver_playback_play","resolver_playback_pause","resolver_resolve_play","resolver_resolve_pause"]);for(a=0;a<c.length;a++){var b=f(c[a]);if(!b.prop("disabled")){b.click();break}}});g()})}});jQuery.extend(jQuery.ns("Kattis.views.submissions.create"),{init:function(){this.editors=[];this.initProblemSelector();this.initLanguageSelector();this.initProblems();this.initLanguages();this.initEditors();jQuery("#submit-solution-form").on("submit",this.setEditorValues.bind(this));var a=jQuery("#sub_files_input");a.on("change",this.onSubmissionFilesChanged.bind(this));a.on("keydown",this.onSubmissionFilesKeypressed.bind(this));a.each(function(a,c){this.update_file_list(c)}.bind(this));this.mainBox(this.data.languages._default,
this.data.form_mainclass);jQuery('[name="editor_visible"]').click(this.onSwitchToEditor.bind(this));jQuery("#file-upload").click(this.onSwitchToFileUpload.bind(this));jQuery("#cancel").click(this.onCancelClicked.bind(this))},initProblemSelector:function(){var a=this.data.is_contest?"fulltitle":"problem_name";jQuery("#problem_select").select2({placeholder:this.data.problems.placeholder,data:this.data.problems.available.map(function(b){return{id:b.problem_name,text:b[a]}})})},initLanguageSelector:function(){var a=
jQuery("#language_select");a.select2({placeholder:this.data.languages.placeholder,data:this.data.languages.available.map(function(a){return{id:a.language_name,text:a.language_name}})});a.on("change",this.onLanguageChanged.bind(this))},initProblems:function(){this.problems={};this.data.problems.available.forEach(function(a){this.problems[a.problem_name]=a.problem_name;if(this.data.is_contest){var b=a.fulltitle.split(" - ")[0].toLowerCase();this.problems[b]=a.problem_name}},this)},initLanguages:function(){this.languages=
{};this.data.languages.available.forEach(function(a){this.languages[a.language_name]=!0},this)},onLanguageChanged:function(){this.setLanguage(this.getSelectedLanguage(),"")},initEditors:function(){var a=this;jQuery(".source-code-editor").each(function(){var b=a.newEditor(this.id),c="ace/mode/"+getAceMode(a.data.languages._default);b.setTheme("ace/theme/textmate");b.getSession().setMode(c);b.setShowPrintMargin(!1);b.session.setUseWorker(!1);jQuery(this).parents("#editor_resize").resizable({handles:"se",
grid:[1E4,1],resize:function(){b.resize()}})})},mainBox:function(a,b){var c=1<this.data.filecount||1<this.editors.length,d="",e="",f=!0,g=!0,h;a=a.toLowerCase();0===a.indexOf("java")&&0!==a.indexOf("javascript")?(h="java",g=!1):0===a.indexOf("javascript")&&c?h="javascript":0===a.indexOf("pascal")?h="pascal":0===a.indexOf("php")&&c?h="php":0===a.indexOf("python")&&c?h="python":0===a.indexOf("ruby")&&c?h="ruby":0===a.indexOf("scala")?(h="scala",g=!1):0===a.indexOf("kotlin")?(h="kotlin",g=!1):f=!1;f&&
(d=this.data.main_box_msg[h].help,e=this.data.main_box_msg[h].label);h=jQuery("#mainBox");var m=h.find("#main_select");b||(0<m.length&&(b=m.val()),c&&g&&(b=this.adjustFilename(b)));c="";f&&(c=["<div class='form-group'>","<label for='main_select' title='"+d+"'>",e,"</label>","<input class='form-control' id='main_select' title='"+d+"' type='text' name='mainclass' value='"+escapeHtml(b)+"' tabindex='4' />","</div>"].join(""));h.html(c)},hideEditor:function(a){jQuery("input[name='type']").val("files");
jQuery("#editor_resize").css("display","none")},showEditor:function(a){jQuery("input[name='type']").val("editor");jQuery("#editor_resize").css("display","block")},newEditor:function(a){var b=ace.edit(a);this.editors.push({name:a,editor:b});return b},setEditorValues:function(){for(var a=this.editors,b=0;b<a.length;++b){var c=a[b].name+"_submit",d=a[b].editor.getValue();jQuery("#"+c).val(d)}},setEditorLanguage:function(a){a="ace/mode/"+getAceMode(a);for(var b=this.editors,c=0;c<b.length;++c)b[c].editor.getSession().setMode(a)},
setLanguage:function(a,b){this.setEditorLanguage(a);this.mainBox(a,b)},getSelectedLanguage:function(){return jQuery("#language_select").val()},adjustFilename:function(a){if(!jQuery("#file_dialog").is(":visible"))return a;var b=jQuery("#sub_files_input")[0].files;if(!b)return a;for(var c=0;c<b.length;c++)if(/^[Mm]ain\./.test(b[c].name))return b[c].name;for(c=0;c<b.length;c++)if(b[c].name===a)return a;return b[0]?b[0].name:a},fileDialogEnabled:function(a,b){var c=this.getSelectedLanguage();this.data.filecount=
a.files?a.files.length:1;this.mainBox(c,b||"")},editorEnabled:function(){var a=this.getSelectedLanguage();this.data.filecount=1;this.mainBox(a,"")},submitForm:function(a){"function"===typeof a.submit?a.submit():a.submit.click()},isLanguageAvailable:function(a){return!!this.languages[a]},languageFromExtension:function(a,b){var c={c:"C","c#":"C#","c++":"C++",C:"C++",cc:"C++",cpp:"C++",cs:"C#",cxx:"C++",go:"Go",hs:"Haskell",java:"Java",js:"JavaScript",m:"Objective-C",pas:"Pascal",php:"PHP",pl:"Prolog",
rb:"Ruby",scala:"Scala",sc:"Scala",kt:"Kotlin"};if("C"===a)return"C++";a=a.toLowerCase();if(c.hasOwnProperty(a))return c[a];if("h"===a){for(var c=!1,d=0;d<b.length;d++)"c"===b[d]&&(c=!0);return!this.isLanguageAvailable("C++")||this.isLanguageAvailable("C")&&c?"C":"C++"}return null},isPython2:function(a){if(!this.isLanguageAvailable("Python 2"))return!1;if(!this.isLanguageAvailable("Python 3"))return!0;var b=/^\s*\bprint\b *[^ \(\),\]]|\braw_input\b/,c=a.split("\n");if(0===a.lastIndexOf("#!",0)){if(-1!==
c[0].indexOf("python2"))return!0;if(-1!==c[0].indexOf("python3"))return!1}for(a=0;a<c.length;a++){var d=c[a],e=d.indexOf("#");-1!==e&&(d=d.substr(0,e));if(b.test(d))return!0}return!1},readFile:function(a,b){var c=b.scope||this,d=new FileReader;d.onload=function(){var a=d.result,f=a.indexOf("base64,");-1!==f?(a=atob(a.substr(f+7)),b.success.call(c,a)):b.failure.call(c)}.bind(this);d.onerror=d.onabort=function(){b.failure.call(c)};d.readAsDataURL(a)},guessProblem:function(a,b){if(a)for(var c=0;c<a.length;c++){var d=
a[c].name.toLowerCase(),e=d.indexOf(".");-1!==e&&(d=d.substr(0,e));if(this.problems.hasOwnProperty(d)){b.call(this,this.problems[d]);break}}},checkJavaFile:function(a,b,c){var d=c.scope||this,e=a.name;/\.java$/i.test(e)?(e=e.slice(0,-5),this.readFile(a,{success:function(a){if(/ main\s*\(/.test(a)){if(-1===a.indexOf("class "+e)){var g=a.match(/\bclass\s*(\w+)/);e=g?g[1]:e}g=a.match(/(?:\n|^)package +([\w.]+) *;/);c.success.call(d,g?g[1]+"."+e:e)}else c.failure.call(d,b,c)},failure:function(){c.failure.call(d,
b,c)},scope:this})):c.failure.call(d,b,c)},checkScalaFile:function(a,b,c){var d=c.scope||this,e=a.name;/\.sc(ala)?$/i.test(e)?(e=/\.sc$/i.test(e)?e.slice(0,-3):e.slice(0,-6),this.readFile(a,{success:function(a){if(/ main\s*\(/.test(a)){if(-1===a.indexOf("class "+e)){var g=a.match(/\bclass\s*(\w+)/);e=g?g[1]:e}g=a.match(/(?:\n|^)package +([\w.]+)/);console.log(a);console.log("m = ",g);c.success.call(d,g?g[1]+"."+e:e)}else c.failure.call(d,b,c)},failure:function(){c.failure.call(d,b,c)},scope:this})):
c.failure.call(d,b,c)},checkKotlinFile:function(a,b,c){var d=c.scope||this;filename=a.name;if(/\.kt$/i.test(filename)){filename=filename.slice(0,-3);var e=filename.charAt(0).toUpperCase()+filename.slice(1)+"Kt";this.readFile(a,{success:function(a){/fun\s+main\s*\(/.test(a)?((a=a.match(/(?:\n|^)package +([\w.]+) *;/))&&(e=a[1]+"."+e),c.success.call(d,e)):c.failure.call(d,b,c)},failure:function(){c.failure.call(d,b,c)},scope:this})}else c.failure.call(d,b,c)},checkPascalFile:function(a,b,c){var d=c.scope||
this,e=a.name;/\.pas$/i.test(e)?this.readFile(a,{success:function(a){/^\s*[Pp]rogram\s*\(/.test(a)?c.success.call(d,e):c.failure.call(d,b,c)},failure:function(){c.failure.call(d,b,c)},scope:this}):c.failure.call(d,b,c)},guessJavaMainClass:function(a,b){for(var c=0;c<a.length;c++)if(/^[Mm]ain\.java$/.test(a[c].name)){b.call(this,a[c].name.slice(0,-5));return}this.checkJavaFile(a[0],0,{success:function(a){b.call(this,a)},failure:function(c,e){c>=a.length-1?b.call(this,""):this.checkJavaFile(a[c+1],
c+1,e)},scope:this})},guessScalaMainClass:function(a,b){for(var c=0;c<a.length;c++){if(/^[Mm]ain\.scala$/.test(a[c].name)){b.call(this,a[c].name.slice(0,-6));return}if(/^[Mm]ain\.sc$/.test(a[c].name)){b.call(this,a[c].name.slice(0,-3));return}}this.checkScalaFile(a[0],0,{success:function(a){b.call(this,a)},failure:function(c,e){c>=a.length-1?b.call(this,""):this.checkScalaFile(a[c+1],c+1,e)},scope:this})},guessKotlinMainClass:function(a,b){for(var c=0;c<a.length;c++)if(/^[Mm]ain\.kt$/.test(a[c].name)){c=
a[c].name.slice(0,-3);c=c.charAt(0).toUpperCase()+c.slice(1)+"Kt";b.call(this,c);return}this.checkKotlinFile(a[0],0,{success:function(a){b.call(this,a)},failure:function(c,e){c>=a.length-1?b.call(this,""):this.checkKotlinFile(a[c+1],c+1,e)},scope:this})},guessPascalMainFile:function(a,b){for(var c=0;c<a.length;c++)if(/^[Mm]ain\.pas$/.test(a[c].name)){b.call(this,a[c].name);return}this.checkPascalFile(a[0],0,{success:function(a){b.call(this,a)},failure:function(c,e){c>=a.length-1?b.call(this,""):this.checkPascalFile(a[c+
1],c+1,e)},scope:this})},guessLanguage:function(a,b){for(var c=a?a.length:0,d=[],e=0;e<c;e++)d.push(a[e].name.split(".").reverse()[0]||"");for(e=0;e<c;e++){var f=a[e],g=d[e],h=this.languageFromExtension(g,d);if("Java"===h){this.guessJavaMainClass(a,function(a){b.call(this,h,a)});return}if("Scala"===h){this.guessScalaMainClass(a,function(a){b.call(this,h,a)});return}if("Kotlin"===h){this.guessKotlinMainClass(a,function(a){b.call(this,h,a)});return}if(null!==h){b.call(this,h);return}if("py"===g){this.readFile(f,
{success:function(a){b.call(this,this.isPython2(a)?"Python 2":"Python 3")},failure:function(){b.call(this,"Python 3")},scope:this});return}}b.call(this)},update_file_list:function(a){var b=jQuery(a).parent();b.removeClass("has_files");if(0!==a.files.length){b.addClass("has_files");b=b.find(".file_list");b.empty();for(var c=0;c<a.files.length;++c)b.append(jQuery("<li/>").text(a.files[c].name))}},onSubmissionFilesChanged:function(a){var b=a.target;this.hideEditor(this.data.editor_id);jQuery("#cancel").prop("disabled",
!1);this.guessLanguage(b.files,function(a,c){if(a&&this.isLanguageAvailable(a)){var f=jQuery("#language_select");f.val(a);f.trigger("change")}this.fileDialogEnabled(b,c)});var c=jQuery("#problem_select");c&&!c.val()&&this.guessProblem(b.files,function(a){c.val(a);c.trigger("change")});this.update_file_list(b)},onSubmissionFilesKeypressed:function(a){13===a.which&&a.ctrlKey&&this.submitForm(a.target.form)},onSwitchToEditor:function(){this.showEditor(this.data.editor_id);jQuery("#file_dialog").hide();
jQuery("#editor_dialog").show();jQuery("#cancel").prop("disabled",!1);this.editorEnabled()},onSwitchToFileUpload:function(){this.hideEditor(this.data.editor_id);jQuery("#file_dialog").show();jQuery("#editor_dialog").hide();jQuery("#cancel").prop("disabled",!0)},onCancelClicked:function(){window.location=this.data.location}});jQuery.extend(jQuery.ns("Kattis.views.recruiting.view_candidate"),function(){var a={MIN_DIFFICULTY:1,MAX_DIFFICULTY:10,PDF_CURVE_STEPS:30,init:function(){this.checkModalDialogs();this.data.has_recruiter_rights||this.drawGraph();this.initTests()},checkModalDialogs:function(){["#assign-tasks","#request-ratings","#request-test"].forEach(function(a){window.location.hash===a&&jQuery(a).modal("show")})},initTests:function(){var a=jQuery("#test-summary");a.circliful();0!=this.data.tests.length&&jQuery(".circle-text-half").replaceWith(function(){var b=
jQuery.trim(jQuery(this).text()),e=jQuery.trim(a.data("link"));e&&(b='<a href="'+e+'">'+b+"</a>");return'<span class="circle-text-half" style="line-height: 179.31px; font-size: 40px;">'+b+"</span>"})},getPixelRatio:function(a){return(window.devicePixelRatio||1)/(a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1)},rayleigh:function(a){var b=Math.pow(2.8385,2);return a/b*Math.exp(-(a*
a)/(2*b))},renderPDFcurve:function(a,b){for(var e=[],f=0,g=0;g<this.PDF_CURVE_STEPS;++g){var h=(this.MAX_DIFFICULTY-this.MIN_DIFFICULTY)*g/this.PDF_CURVE_STEPS+this.MIN_DIFFICULTY,m=this.rayleigh(h),f=Math.max(f,m);e.push([h,m])}var k=a.height,l=a.width;b.translate(0,-77.5);b.beginPath();b.moveTo(0,k);for(g=0;g<e.length;++g)h=e[g][0]*l/(this.MAX_DIFFICULTY-this.MIN_DIFFICULTY+1),m=k-0.9*(e[g][1]*(k-77.5)/f),b.lineTo(h,m);b.lineTo(h,k);b.closePath();b.fillStyle="#E7E7E7";b.fill()},drawGraphTail:function(a,
b){if(this.data.is_set_hardest_accepted){var e=a.height,f=a.width;b.globalCompositeOperation="source-atop";b.beginPath();var g=this.data.hardest_accepted_array,h=this.data.hardest_accepted_after;b.moveTo(g.problem_difficulty*(f/10)-50,50);b.lineTo(h.problem_difficulty*(f/10)-50,50);b.lineTo(h.problem_difficulty*(f/10)-50,e);b.lineTo(g.problem_difficulty*(f/10)-50,e);b.closePath();b.fillStyle="#449fe1";b.fill();b.globalCompositeOperation="source-over"}},drawBreakpoint:function(a,b){for(var e=a.height,
f=a.width,g=[this.data.recommendation_limit],h=[],m=0;m<g.length;m++)h.push(g[m]*(f/10)-50);for(m=0;m<h.length;m++)b.beginPath(),b.lineWidth=10,b.strokeStyle="black",b.moveTo(h[m],20),b.lineTo(h[m],e),b.strokeStyle="#f0b034",b.stroke()},drawXAxisTicks:function(a,b){for(var e=a.height,f=a.width,g=1;g<=this.MAX_DIFFICULTY;g++)b.font="bold 24px Arial",b.fillStyle="#1E1E1E",b.fillText(g,f/10*g-57,e+36)},drawProblemsInfo:function(a,b){for(var e=a.height,f=a.width,g=[],h=[],m=[],k=0;k<this.data.values_to_plot.length;++k){var l=
this.data.values_to_plot[k];g.push(l.problem_difficulty);!0==l.solved?m.push("#52BB50"):!1==l.solved?m.push("#F20708"):m.push("#C7C7C7")}for(k=0;k<g.length;k++)h.push(g[k]*(f/10)-50);for(var v=this.data.height_top_offset,k=0;k<h.length;k++)b.beginPath(),b.lineWidth=2,b.strokeStyle="black",b.moveTo(h[k],v),b.lineTo(h[k],e),b.stroke();h.forEach(function(a,c){b.beginPath();b.arc(a,v,10,0,2*Math.PI,!1);b.fillStyle=m[c];b.fill();b.lineWidth=2;b.stroke()})},drawGraph:function(){var a=this.data.initial_width,
b=document.getElementById("curve"),e=b.getContext("2d");b.width=2*a;b.height=360;b.style.width=a+"px";b.style.height="180px";e.scale(this.getPixelRatio,this.getPixelRatio);this.renderPDFcurve(b,e);this.drawXAxisTicks(b,e);this.drawGraphTail(b,e);this.drawBreakpoint(b,e);this.drawProblemsInfo(b,e)}},b=!1;return{init:function(){b||(b=!0,a.data=this.data,this.data=null,a.init())}}}());jQuery.extend(jQuery.ns("Kattis.views.admin.course_offering_edit"),function(){var a={init:function(){this.createBtn=jQuery(".create-btn");jQuery(".field_toggle_null").on("change",this.onCheckboxClick.bind(this));jQuery("#offering_offering_short_name").on("keyup input",this.onOfferingShortNameChanged.bind(this));jQuery("#offering_offering_end").on("change keyup input",this.onOfferingEndChanged.bind(this));jQuery("#offering_offering_registration_key").on("change keyup input",this.onRegistrationKeyChanged.bind(this));
jQuery(".course-offering-form input[pattern], .course-offering-form input[type=checkbox]").on("change keyup input",this.onFormFieldChanged.bind(this));this.initTeachers();this.initProblemgroups()},initTeachers:function(){this.teacher_tbody=jQuery(".table-teachers tbody");this.teacher_tmpl=tmpl("teacher_tmpl");jQuery(".add-teacher-btn").on("click",this.onAddTeacher.bind(this));jQuery(".add-teacher-username").bind("change keyup input",function(){jQuery(".add-teacher-btn").prop("disabled",""===jQuery(this).val())});
jQuery(".add-teacher-username").keypress(function(a){if(13==a.keyCode&&!jQuery(".add-teacher-btn").prop("disabled"))return jQuery(".add-teacher-btn").click(),a.preventDefault(),!1});this.data.teachers.forEach(function(a,b){this.addTeacherRow({teacher_no:b,name:a.name,username:a.username,link:Kattis.API.user_view+"/"+a.username},!1)},this);this.teacher_no=this.data.teachers.length},initProblemgroups:function(){this.problemgroup_tbody=jQuery(".table-problemgroups tbody");this.problemgroup_tmpl_old=
tmpl("problemgroup_tmpl_old");this.problemgroup_tmpl_new=tmpl("problemgroup_tmpl_new");jQuery(".add_problemgroup").on("click",this.onAddProblemGroup.bind(this));jQuery("#input_problem_group_name").select2({allowClear:!0,createSearchChoice:function(a,b){if(0===jQuery(b).filter(function(){return 0===this.text.localeCompare(a)}).length)return{id:"0",text:a,exists:!1}},data:this.data.all_problemgroups.map(function(a){return{id:a.id,text:a.name,exists:!0}}),formatResult:function(a,b,e,f){return a.exists?
f(a.text):f(a.text)+" <i>(new)</i>"}});this.data.problemgroups.forEach(function(a,b){var e=a.id?Kattis.API.problemgroup_edit.replace("{0}",a.id):"";this.addProblemgroupRow({problemgroup_no:b,id:a.id,name:a.name,link:e},!1)},this);this.problemgroup_no=this.data.problemgroups.length},addTeacherRow:function(a,b){var e=jQuery(this.teacher_tmpl(a)),f=b?e.children("td"):jQuery();e.find(".remove-teacher-btn").bind("click",this.onRemoveTeacher.bind(this));f.attr("style","display: none;");this.teacher_tbody.append(e);
f.slideDown("fast")},addProblemgroupRow:function(a,b){var e=jQuery((void 0===a.id?this.problemgroup_tmpl_new:this.problemgroup_tmpl_old)(a)),f=b?e.children("td"):jQuery();e.find(".remove-problemgroup-btn").bind("click",this.onRemoveProblemGroup.bind(this));f.attr("style","display: none;");this.problemgroup_tbody.append(e);f.slideDown("fast")},removeTableRow:function(a){a.children("td").slideUp("fast",function(){a.remove()})},isValid:function(){for(var a=jQuery(".course-offering-form input[pattern]:not([disabled])").toArray(),
b=jQuery(".course-offering-form .form-group.has-error"),e=jQuery(".course-offering-form span.fa"),b=0==b.length&&0==e.length,e=0;e<a.length;++e)var f=jQuery(a[e]),b=b&this.isPatternFieldValid(f);return b},updateCreateBtn:function(){this.createBtn.prop("disabled",!this.isValid())},onFormFieldChanged:function(a){9==a.keyCode||16==a.keyCode||(jQuery(a.target).closest("div.form-group").addClass("has-warning"),this.updateCreateBtn())},toggleInputValidation:function(a,b){a.parents(".form-group").toggleClass("has-error",
!b)},isPatternFieldValid:function(a){return RegExp(a.attr("pattern")).test(a.val())},validatePatternField:function(a){var b=this.isPatternFieldValid(a);this.toggleInputValidation(a,b);return b},onRegistrationKeyChanged:function(a){this.validatePatternField(jQuery(a.target))},onOfferingEndChanged:function(a){a=jQuery(a.target);var b=a.val();this.validatePatternField(a)&&(b="infinity"==b||Kattis.util.isValidDate(b),this.toggleInputValidation(a,b))},onOfferingShortNameChanged:function(a){var b=jQuery(a.target),
e=b.parent().children("span"),f=b.val();this.call_id=(this.call_id||0)+1;this.hintTimeout&&(clearTimeout(this.hintTimeout),this.hintTimeout=null);this.validatePatternField(b)?this.data.offering_short_name==f?(e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success"),this.toggleInputValidation(b,!0)):(e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success").addClass("fa fa-spinner fa-spin"),
this.createBtn.prop("disabled",!0),this.hintTimeout=setTimeout(function(a){jQuery.ajax({type:"GET",url:Kattis.API.ajax_course_offering_short_name_available,data:{course_short_name:this.data.course_short_name,offering_short_name:f},context:this}).always(function(){e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success")}).done(function(c){a===this.call_id&&(this.toggleInputValidation(b,c.response.available),e.addClass(c.response.available?"glyphicon glyphicon-ok text-success":
"glyphicon glyphicon-remove text-danger"),this.updateCreateBtn())}).fail(function(){a===this.call_id&&(this.toggleInputValidation(b,!1),e.addClass("glyphicon glyphicon-remove text-danger"),this.updateCreateBtn())})}.bind(this),750,this.call_id)):e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success")},onCheckboxClick:function(a){var b=jQuery(a.target);a=b.prop("checked");b=b.data("toggleid");b=jQuery("#"+b);b.prop("disabled",!a);a?this.validatePatternField(b):
this.toggleInputValidation(b,!0)},onRemoveTeacher:function(a){var b=jQuery(a.target);b.prop("disabled",!0);var e=b.closest("tr");this.data.is_new?(this.removeTableRow(e),e.closest("div.form-group").addClass("has-warning"),this.updateCreateBtn()):(a={course_short_name:this.data.course_short_name,offering_short_name:this.data.offering_short_name,user_name:e.attr("data-username"),csrf_token:this.data.csrf_token},jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_course_offering_teacher,contentType:"application/json",
data:JSON.stringify(a),context:this}).done(function(){this.removeTableRow(e)}).fail(function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)}))},onAddTeacher:function(a){var b=jQuery(a.target),e=jQuery(".add-teacher-username");a=e.val();b.prop("disabled",!0);var f={always:function(){e.focus()},done:function(a){e.val("");this.addTeacherRow({teacher_no:this.teacher_no++,username:a.response.username,name:a.response.name,link:Kattis.API.user_view+
"/"+a.response.username},!0);this.data.is_new&&(e.closest("div.form-group").addClass("has-warning"),this.updateCreateBtn())},fail:function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)},scope:this};this.data.is_new?this.getAuthor(a,f):this.postTeacher(a,f)},postTeacher:function(a,b){jQuery.ajax({type:"POST",url:Kattis.API.ajax_course_offering_teacher,contentType:"application/json",data:JSON.stringify({course_short_name:this.data.course_short_name,
offering_short_name:this.data.offering_short_name,user_name:a,csrf_token:this.data.csrf_token}),context:b.scope||this}).always(b.always).done(b.done).fail(b.fail)},getAuthor:function(a,b){jQuery.ajax({type:"GET",url:Kattis.API.ajax_author,contentType:"application/json",data:{username:a},context:b.scope||this}).always(b.always).done(b.done).fail(b.fail)},onRemoveProblemGroup:function(a){a=jQuery(a.target);this.removeTableRow(a.closest("tr"));a.closest("div.form-group").addClass("has-warning");this.updateCreateBtn()},
onAddProblemGroup:function(){var a=jQuery("#input_problem_group_name"),b=a.select2("data"),e=b.id,b={name:b.text,problemgroup_no:this.problemgroup_no++};"0"!=e&&(b.id=e,b.link=Kattis.API.problemgroup_edit.replace("{0}",e));this.addProblemgroupRow(b,!0);a.closest("div.form-group").addClass("has-warning");this.updateCreateBtn();a.select2("val","")}},b=!1;return{init:function(){b||(b=!0,a.data=this.data,this.data=null,a.init())}}}());jQuery.extend(jQuery.ns("Kattis.main"),{init:function(){jQuery(".selectify-this").select2();jQuery('[data-toggle="tooltip"]').tooltip();jQuery(".site-search > a").on("click",function(){jQuery(this).parent().find("input").focus()});jQuery(".site-search > input").on("focus",function(){jQuery(this).parent().addClass("active")});jQuery("body").on("click",function(a){jQuery(".site-search").each(function(){!jQuery(this).is(a.target)&&0===jQuery(this).has(a.target).length&&jQuery(this).removeClass("active")})});
jQuery("#filter li a").click(function(a){a=jQuery(this).text();var b=jQuery(this).parent().attr("data-value");jQuery("#main_filter_text").text(a);jQuery("#filter_by").val(b);"all"===b?jQuery("#filter_by_value").prop("disabled",!0):jQuery("#filter_by_value").prop("disabled",!1).focus()})}});var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escapeHtml(a){return String(a).replace(/[&<>"'\/]/g,function(a){return entityMap[a]})}
function twodigit(a){return(10>a?"0":"")+a}function format_interval(a,b,c){b="undefined"!==typeof b?b:!1;var d=0>a;d&&(a=-a);a=Math.floor(a);var e=Math.floor(a/3600),f=Math.floor(a/60)%60;a%=60;var g="";"undefined"!==typeof c&&c&&(c=Math.floor(e/24),e%=24,0<c&&(b=!0,g+=c+" day"+(1!=c?"s":"")+" "));if(0<e||b)g+=e+":";g+=twodigit(f)+":"+twodigit(a);d&&(g="-"+g);return g}
function initContestHeader(a,b,c){var d=window.page_loaded_at;jQuery(function(e){var f=e(".contest-progress"),g=function(a,b){b&&!f.hasClass(a)?f.addClass(a):!b&&f.hasClass(a)&&f.removeClass(a)},h=-30>b,m=2>b;setInterval(function(){var e=Math.floor(b+(new Date-d)/1E3),l=-30>e,v=2>e;a&&(m&&!v||h&&!l)&&location.reload();h=l;m=v;var s=v=!1,C=!1,l=!1;a?0>e?C=!0:e>=c?s=!0:900>=c-e&&(v=!0):(l=!0,e=0);g("session-nostart",l);g("session-notstarted",C);g("session-nearend",v);g("session-finished",s);0>e&&f.find(".countdown").text(format_interval(-e,
!1,!0));e=Math.max(0,e);e=Math.min(c,e);v=0;l||(v=100*e/c);f.find(".count_elapsed").text(format_interval(e,!0));f.find(".count_remaining").text(format_interval(c-e,!0));f.find(".progress-bar").css("width",v.toString()+"%")},1E3)});return function(e,f,g,h){a=e;b=f;c=g;d=h}}
jQuery.extend(jQuery.ns("Kattis"),function(){var a={"page-master-layout":Kattis.main,"page-contest-edit":Kattis.views.contest.edit,"page-contest-resolver":Kattis.views.contest.resolver,"page-submit":Kattis.views.submissions.create,"page-view-candidate":Kattis.views.recruiting.view_candidate,"page-course-offering-edit":Kattis.views.admin.course_offering_edit};return{init:function(){document.body.attributes["class"].value.split(/\s+/g).forEach(this.run_module,this)},run_module:function(b){a[b]&&a[b].init.call(a[b])}}}());
jQuery(Kattis.init.bind(Kattis));
