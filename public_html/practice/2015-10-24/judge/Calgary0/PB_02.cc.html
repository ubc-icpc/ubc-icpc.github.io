<!DOCTYPE html>
<html>
<head>
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css" />
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCpp.js" type="text/javascript"></script>
<style type="text/css">.syntaxhighlighter{overflow-y: hidden !important; overflow-x: auto !important;}</style></head>
<body>
<pre class="brush: cpp">
#include &lt;bits/stdc++.h&gt;
using namespace std;

vector&lt;string&gt; solve(int n) {
	if(n == 1) {
		vector&lt;string&gt; res;
		res.push_back(&quot;1&quot;);
		return res;
	}
	if(n == 2) {
		vector&lt;string&gt; res;
		res.push_back(&quot;12&quot;);
		res.push_back(&quot;21&quot;);
		return res;
	}
	if(n == 3) {
		vector&lt;string&gt; res;
		res.push_back(&quot;123&quot;);
		res.push_back(&quot;213&quot;);
		res.push_back(&quot;231&quot;);
		res.push_back(&quot;321&quot;);
		res.push_back(&quot;312&quot;);
		res.push_back(&quot;132&quot;);
		return res;
	}
	vector&lt;string&gt; tmp = solve(n-1);
	vector&lt;string&gt; res;
	char N = char(n+'0');
	for(int i = 0; i &lt; tmp.size(); i += 2) {
		for(int k = 0; k &lt; n; k++)
			res.push_back(tmp[i].substr(0, n-k-1) + N + tmp[i].substr(n-k-1));
		if(i+1 &lt; tmp.size())
			for(int k = 0; k &lt; n; k++)
				res.push_back(tmp[i+1].substr(0, k) + N + tmp[i+1].substr(k));
	}
	return res;
}

vector&lt;string&gt; res;

int main () {
	int n;
	cin &gt;&gt; n;
	res = solve(n);
	for(int i = 0; i &lt; res.size(); i++) {
		for(int j = 0; j &lt; n; j++)
			cout &lt;&lt; res[i][j] &lt;&lt; &quot; &quot;;
		cout &lt;&lt; endl;
	}
	return 0;
}</pre>
</body>
<script type="text/javascript">SyntaxHighlighter.all()</script></html>
