<!DOCTYPE html>
<html>
<head>
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css" />
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCpp.js" type="text/javascript"></script>
<style type="text/css">.syntaxhighlighter{overflow-y: hidden !important; overflow-x: auto !important;}</style></head>
<body>
<pre class="brush: cpp">
#include &lt;bits/stdtr1c++.h&gt;
using namespace std;

typedef long long ll;

ll bin(ll n, ll k)
{
    ll den = 1, num = 1;
    for (int i = 1; i &lt;= k; i = i + 1) den = den * i;
    for (int j = n - k + 1; j &lt;= n; j = j + 1) num = num * j;
    return num / den;
}

int main() {
	while(true) {
		int n, r; cin &gt;&gt; n &gt;&gt; r;
		if (n == 0 &amp;&amp; r == 0) return 0;
		vector&lt;int&gt; list;
		int rules[n][n];
		memset(rules,0,sizeof rules);
		for (int i=0; i&lt;r; i++) {
			int a,b; cin &gt;&gt; a &gt;&gt; b;
			a--; b--;
			rules[a][b] = 1;
		}

		for (int i=0; i&lt;n; i++) {
			list.push_back(i);
		}
		
		ll perm1 = 0, perm2 = 0;

		do {
			for (int i=0; i&lt;n/2; i++) {
				for (int j=i+1; j&lt;n/2; j++) {
					if (rules[list[i]][list[j]]) goto label1;
				}
			}
			perm1++;
			label1: ;
		} while(next_permutation(list.begin(), list.begin()+n/2));

		do {
			for (int i=n/2; i&lt;n; i++) {
				for (int j=i+1; j&lt;n; j++) {
					if (rules[list[i]][list[j]]) goto label2;
				}
			}
			perm2++;
			label2: ;
		} while(next_permutation(list.begin()+n/2, list.end()));
		
		cout &lt;&lt; bin(n,n/2)*perm1*perm2 &lt;&lt; endl;	
	}
	
	return 0;
}</pre>
</body>
<script type="text/javascript">SyntaxHighlighter.all()</script></html>
