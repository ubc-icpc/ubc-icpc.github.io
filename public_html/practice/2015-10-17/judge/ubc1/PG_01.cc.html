<!DOCTYPE html>
<html>
<head>
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css" />
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCpp.js" type="text/javascript"></script>
<style type="text/css">.syntaxhighlighter{overflow-y: hidden !important; overflow-x: auto !important;}</style></head>
<body>
<pre class="brush: cpp">
#include &lt;iostream&gt;

using namespace std;

bool m[2001][2001];
int v[2001][2001], h[2001][2001], s[2001][2001];

int main() {
	ios::sync_with_stdio(0);
	cin.tie(0);
	int t; cin &gt;&gt; t;
	while (t--) {
		int n; cin &gt;&gt; n;
		for (int i = 1; i &lt;= n; i++) {
			for (int j = 1; j &lt;= n; j++) {
				char c; cin &gt;&gt; c;
				if(c=='E')
					m[i][j] = 1;
				if(c=='F')
					m[i][j] = 0;
			}
			}
		for(int i=1;i&lt;=n;++i)
			for(int j=n;j;--j)
			{
				if(!m[i][j])
					h[i][j]=0;
				else 
					if(n!=j)
					h[i][j] = 1+h[i][j+1];
					else
					h[i][j] = 1;
			}
		for(int j=1;j&lt;=n;++j)
			for(int i=n;i;--i)
			{
				if(!m[i][j])
					v[i][j]=0;
				else if(n!=i)
					v[i][j] = 1+v[i+1][j];
				else
					v[i][j] = 1;
			}
		int ans = 0;
		for(int j=n;j;--j)
		for(int i=n;i;--i)
		{
			if(!m[i][j])
				s[i][j] = 0;
			else
				if(i!=n &amp;&amp; j!=n)
					s[i][j] = 1 + min(h[i][j+1], min(v[i+1][j], s[i+1][j+1]));
				else
					s[i][j] = 1;
			ans = max(ans,s[i][j]);
		}
		/*for(int i=1;i&lt;=n;++i)
		{
		for(int j=1;j&lt;=n;++j)
		cout&lt;&lt;v[i][j]&lt;&lt;' '; cout&lt;&lt;endl;
		}
		
				for(int i=1;i&lt;=n;++i)
		{
		for(int j=1;j&lt;=n;++j)
		cout&lt;&lt;h[i][j]&lt;&lt;' '; cout&lt;&lt;endl;
		}
		
				for(int i=1;i&lt;=n;++i)
		{
		for(int j=1;j&lt;=n;++j)
		cout&lt;&lt;s[i][j]&lt;&lt;' '; cout&lt;&lt;endl;
		}*/
		cout&lt;&lt;ans&lt;&lt;endl;
	}
	return 0;
}
</pre>
</body>
<script type="text/javascript">SyntaxHighlighter.all()</script></html>
