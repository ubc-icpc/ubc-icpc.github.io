<!DOCTYPE html>
<html>
<head>
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css" />
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCpp.js" type="text/javascript"></script>
<style type="text/css">.syntaxhighlighter{overflow-y: hidden !important; overflow-x: auto !important;}</style></head>
<body>
<pre class="brush: cpp">
#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;math.h&gt;
#include &lt;string&gt;
using namespace std;
int main()
{
    int t;
    cin&gt;&gt;t;
    for(int l=0; l&lt;t; l++)
    {
        int n;
        string a,b;
        cin&gt;&gt;a&gt;&gt;n&gt;&gt;b;
        int bas = 1;
        int son = b.size()-2;
        int eded = 0;
        bool duz = true;
        int say =0;
        for(int i=0; i&lt;a.length(); i++)
        {
            if(a[i]=='R')
            {
                if(duz)
                {
                    duz=false;
                }
                else
                {
                    duz=true;
                }
            }
            else 
            {
                ++say;
                if(say&lt;=n)
                {
                if(duz)
                {
                        int j = bas;
                        bool John = true;
                        while(John)
                        {
                            if(b[j]==',' )
                            {
                                ++bas;
                                b[j]=' ';
                                John=false;
                            }
                            else if(b[j]==' ' )
                            {
                                John=false;
                            }
                            else if(b[j]==']')
                            {
                                --bas;
                                John=false;
                            }
                            else
                            {
                                b[j]=' ';
                                ++bas;
                            }
                            ++j;
                        }
                }
                else
                {
                    int j = son;
                    bool John = true;
                    while(John)
                    {
                        if(b[j]==',')
                        {
                            --son;
                            John=false;
                            b[j]=' ';
                        }
                        else if(b[j]==' ')
                        {
                            John=false;
                        }
                        else if(b[j]=='[')
                        {
                            ++son;
                            John=false;
                        }
                        else
                        {
                            b[j]=' ';
                            --son;
                        }
                        --j;
                    }
                }
                }
            }
        }
        if(say&gt;n)
        {
            cout&lt;&lt;&quot;error&quot;&lt;&lt;endl;
        }
        else
        {
        if(duz)
        {
            for(int i=0; i&lt;b.size(); i++)
            {
                if(b[i]!=' ')
                {
                    cout&lt;&lt;b[i];
                }
            }
            cout&lt;&lt;endl;
        }
        else
        {
            cout&lt;&lt;&quot;[&quot;;
            string eded = &quot;&quot;;
            for(int i=b.size()-1; i&gt;=0; i--)
            {
                if(b[i]==',')
                {
                    cout&lt;&lt;eded&lt;&lt;&quot;,&quot;;
                    eded = &quot;&quot;;
                }
                else if(b[i]!=' ' &amp;&amp; b[i]!=']' &amp;&amp; b[i]!='[')
                {
                    eded=b[i]+eded;
                }
            }
            cout&lt;&lt;eded&lt;&lt;&quot;]&quot;&lt;&lt;endl;
        }
        }
    }
}

</pre>
</body>
<script type="text/javascript">SyntaxHighlighter.all()</script></html>
