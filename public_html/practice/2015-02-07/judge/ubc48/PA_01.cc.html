<!DOCTYPE html>
<html>
<head>
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
<link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css" />
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCpp.js" type="text/javascript"></script>
<style type="text/css">.syntaxhighlighter{overflow-y: hidden !important; overflow-x: auto !important;}</style></head>
<body>
<pre class="brush: cpp">
#include&lt;iostream&gt;
#include&lt;vector&gt;
#include&lt;deque&gt;
using namespace std;
int main() {
	int t; cin &gt;&gt; t;
	for (int i = 0; i &lt; t; ++i) {
		int m, n; cin &gt;&gt; m &gt;&gt; n;
		vector &lt; vector &lt; char &gt; &gt; r(m, vector &lt; char &gt;());
		deque &lt; vector &lt; int &gt; &gt; c;
		for (int j = 0; j &lt; m; ++j) {
			for (int k = 0; k &lt; n; ++k) {
				char temp; cin &gt;&gt; temp;
				if (temp == 'S') {
					vector &lt; int &gt; gar;
					gar.push_back(j);
					gar.push_back(k);
					c.push_back(gar);
				}
				r[j].push_back(temp);
			}
		}
		vector &lt; vector &lt; bool &gt; &gt; tf(m, vector &lt; bool &gt;(n, true));
		tf[c[0][0]][c[0][1]] = false;
		int distance = 1;
		int total = 0;
		while (c.size() &gt; 0) {
			int q = c.size();
			for (int p = 0; p &lt; q; ++p) {
				if (c[0][1] &gt; 0 &amp;&amp; c[0][1] &lt; n - 1) {
					if (tf[c[0][0]][c[0][1] + 1] == true) {
						if (r[c[0][0]][c[0][1] + 1] == 'B') {
							total += 2 * distance;
							tf[c[0][0]][c[0][1] + 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] + 1);
							c.push_back(gar);
						}
						else {
							tf[c[0][0]][c[0][1] + 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] + 1);
							c.push_back(gar);
						}
					}
					if (tf[c[0][0]][c[0][1] - 1] == true) {
						if (r[c[0][0]][c[0][1] - 1] == 'B') {
							total += 2 * distance;
							tf[c[0][0]][c[0][1] - 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] - 1);
							c.push_back(gar);
						}
						else {
							tf[c[0][0]][c[0][1] - 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] - 1);
							c.push_back(gar);
						}
					}
				}
				else if (c[0][1] == 0 &amp;&amp; c[0][1] &lt; n - 1) {
					if (tf[c[0][0]][c[0][1] + 1] == true) {
						if (r[c[0][0]][c[0][1] + 1] == 'B') {
							total += 2 * distance;
							tf[c[0][0]][c[0][1] + 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] + 1);
							c.push_back(gar);
						}
						else {
							tf[c[0][0]][c[0][1] + 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] + 1);
							c.push_back(gar);
						}
					}
				}
				else if (c[0][1] == n - 1 &amp;&amp; c[0][1] &gt; 0) {
					if (tf[c[0][0]][c[0][1] - 1] == true) {
						if (r[c[0][0]][c[0][1] - 1] == 'B') {
							total += 2 * distance;
							tf[c[0][0]][c[0][1] - 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] - 1);
							c.push_back(gar);
						}
						else {
							tf[c[0][0]][c[0][1] - 1] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0]);
							gar.push_back(c[0][1] - 1);
							c.push_back(gar);
						}
					}
				}

				if (c[0][0] &gt; 0 &amp;&amp; c[0][0] &lt; m - 1) {
					if (tf[c[0][0] + 1][c[0][1]] == true) {
						if (r[c[0][0] + 1][c[0][1]] == 'B') {
							total += 2 * distance;
							tf[c[0][0] + 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] + 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
						else {
							tf[c[0][0] + 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] + 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
					}

					if (tf[c[0][0] - 1][c[0][1]] == true) {
						if (r[c[0][0] - 1][c[0][1]] == 'B') {
							total += 2 * distance;
							tf[c[0][0] - 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] - 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
						else {
							tf[c[0][0] - 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] - 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
					}
				}
				else if (c[0][0] == 0 &amp;&amp; c[0][0] &lt; m - 1) {
					if (tf[c[0][0] + 1][c[0][1]] == true) {
						if (r[c[0][0] + 1][c[0][1]] == 'B') {
							total += 2 * distance;
							tf[c[0][0] + 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] + 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
						else {
							tf[c[0][0] + 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] + 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
					}
				}
				else if (c[0][0] == m - 1 &amp;&amp; c[0][0] &gt; 0) {
					if (tf[c[0][0] - 1][c[0][1]] == true) {
						if (r[c[0][0] - 1][c[0][1]] == 'B') {
							total += 2 * distance;
							tf[c[0][0] - 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] - 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
						else {
							tf[c[0][0] - 1][c[0][1]] = false;
							vector &lt; int &gt; gar;
							gar.push_back(c[0][0] - 1);
							gar.push_back(c[0][1]);
							c.push_back(gar);
						}
					}
				}
				c.pop_front();
			}
			++distance;
		}
		cout &lt;&lt; total &lt;&lt; &quot; seconds to blocks get!&quot; &lt;&lt; endl;
	}
	return 0;
}</pre>
</body>
<script type="text/javascript">SyntaxHighlighter.all()</script></html>
